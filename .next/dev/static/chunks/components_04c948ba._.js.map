{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app-1.2/components/ListingMap.tsx"],"sourcesContent":["// components/ListingMap.tsx\n\"use client\";\n\nimport type { Listing } from \"@/lib/mockData\";\nimport { useEffect, useRef, useState } from \"react\";\n\ndeclare global {\n  interface Window {\n    naver: any;\n    navermap_authFailure?: () => void;\n  }\n}\n\n// ✅ Web JS v3: openapi + ncpClientId (동작 확인된 방식)\nconst NAVER_CLIENT_ID =\n  process.env.NEXT_PUBLIC_NAVER_MAP_CLIENT_ID ?? \"hdlzlfn5o0\";\n\nexport default function ListingMap({\n  items,\n  selectedId,\n  onSelect,\n}: {\n  items: Listing[];\n  selectedId?: number | null;\n  onSelect?: (id: number) => void;\n}) {\n  const mapRef = useRef<HTMLDivElement | null>(null);\n  const mapObj = useRef<any>(null);\n  const markersRef = useRef<Record<number, any>>({});\n  const [loaded, setLoaded] = useState(false);\n  const [authFailed, setAuthFailed] = useState(false);\n\n  // 인증 실패 콜백\n  useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    window.navermap_authFailure = function () {\n      console.error(\"[NAVER MAP] Authentication Failed\");\n      setAuthFailed(true);\n    };\n  }, []);\n\n  // SDK 로드\n  useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    if (window.naver?.maps) {\n      setLoaded(true);\n      return;\n    }\n    const id = \"naver-map-sdk\";\n    let s = document.getElementById(id) as HTMLScriptElement | null;\n    const src = `https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=${NAVER_CLIENT_ID}&_=${Date.now()}`;\n    if (!s) {\n      s = document.createElement(\"script\");\n      s.id = id;\n      s.async = true;\n      s.defer = true;\n      document.head.appendChild(s);\n    }\n    s.src = src;\n    s.onload = () => {\n      console.log(\"[NAVER MAP] SDK loaded\", { ncpClientId: NAVER_CLIENT_ID });\n      setLoaded(true);\n    };\n    s.onerror = () => console.error(\"[NAVER MAP] SDK load error\");\n  }, []);\n\n  // 지도/마커\n  useEffect(() => {\n    if (!loaded || !mapRef.current || !window.naver?.maps || authFailed) return;\n    const { naver } = window;\n\n    const first = items[0];\n    const center = first\n      ? new naver.maps.LatLng(first.lat, first.lng)\n      : new naver.maps.LatLng(37.5665, 126.9780);\n    const map = new naver.maps.Map(mapRef.current, {\n      center,\n      zoom: 13,\n      zoomControl: true,\n      zoomControlOptions: { position: naver.maps.Position.TOP_RIGHT },\n    });\n    mapObj.current = map;\n\n    // 기존 마커 제거\n    Object.values(markersRef.current).forEach((m) => m.setMap(null));\n    markersRef.current = {};\n\n    // 마커 생성\n    const bounds = new naver.maps.LatLngBounds();\n    items.forEach((it) => {\n      const pos = new naver.maps.LatLng(it.lat, it.lng);\n      bounds.extend(pos);\n\n      const marker = new naver.maps.Marker({\n        map,\n        position: pos,\n      });\n      markersRef.current[it.id] = marker;\n\n      naver.maps.Event.addListener(marker, \"click\", () => {\n        onSelect?.(it.id);\n        map.panTo(pos);\n      });\n    });\n\n    if (items.length > 1) {\n      map.fitBounds(bounds, { top: 20, left: 20, right: 20, bottom: 20 });\n    }\n  }, [loaded, authFailed, items, onSelect]);\n\n  // 선택된 마커로 포커스\n  useEffect(() => {\n    if (!selectedId || !mapObj.current || !window.naver?.maps) return;\n    const marker = markersRef.current[selectedId];\n    if (!marker) return;\n    const pos = marker.getPosition();\n    mapObj.current.panTo(pos);\n    try {\n      marker.setAnimation(window.naver.maps.Animation.BOUNCE);\n      setTimeout(() => marker.setAnimation(null), 700);\n    } catch {}\n  }, [selectedId]);\n\n  return (\n    <div className=\"relative w-full h-64 rounded-2xl border border-neutral-200 overflow-hidden\">\n      <div ref={mapRef} className=\"w-full h-full\" />\n      {!loaded && (\n        <div className=\"absolute inset-0 flex items-center justify-center text-sm\">\n          지도를 불러오는 중…\n        </div>\n      )}\n      {authFailed && (\n        <div className=\"absolute inset-0 bg-white/85 backdrop-blur flex items-center justify-center p-4 text-xs\">\n          <div className=\"text-center\">\n            <div className=\"text-red-600 font-semibold mb-1\">\n              네이버 지도 인증 실패\n            </div>\n            <div className=\"text-neutral-700\">\n              Web 서비스 URL / ncpClientId 설정을 확인하세요.\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 213, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app-1.2/components/ConsultButtons.tsx"],"sourcesContent":["\"use client\";\n\ntype LeadType = \"LOAN\" | \"INTERIOR\" | \"LEASE\";\n\nexport default function ConsultButtons({ listingId }: { listingId: number }) {\n  async function submit(type: LeadType) {\n    const res = await fetch(\"/api/leads\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ type, listingId, payload: { source: \"listing_detail\" } }),\n    });\n    if (!res.ok) {\n      const t = await res.text();\n      alert(`리드 생성 실패: ${t}`);\n      return;\n    }\n    alert(\"상담 요청 접수 완료\");\n  }\n\n  const base =\n    \"w-full h-10 rounded-xl font-semibold border shadow-sm active:scale-[0.99] transition\";\n  return (\n    <div className=\"grid grid-cols-3 gap-2\">\n      <button onClick={() => submit(\"LOAN\")} className={`${base} bg-sky-50 border-sky-200 text-sky-700`}>\n        대출상담\n      </button>\n      <button onClick={() => submit(\"INTERIOR\")} className={`${base} bg-sky-100 border-sky-300 text-sky-800`}>\n        인테리어상담\n      </button>\n      <button onClick={() => submit(\"LEASE\")} className={`${base} bg-sky-200 border-sky-400 text-sky-900`}>\n        임차상담\n      </button>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;;AAIe,SAAS,eAAe,EAAE,SAAS,EAAyB;IACzE,eAAe,OAAO,IAAc;QAClC,MAAM,MAAM,MAAM,MAAM,cAAc;YACpC,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAM;gBAAW,SAAS;oBAAE,QAAQ;gBAAiB;YAAE;QAChF;QACA,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,MAAM,IAAI,MAAM,IAAI,IAAI;YACxB,MAAM,CAAC,UAAU,EAAE,GAAG;YACtB;QACF;QACA,MAAM;IACR;IAEA,MAAM,OACJ;IACF,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAO,SAAS,IAAM,OAAO;gBAAS,WAAW,GAAG,KAAK,sCAAsC,CAAC;0BAAE;;;;;;0BAGnG,6LAAC;gBAAO,SAAS,IAAM,OAAO;gBAAa,WAAW,GAAG,KAAK,uCAAuC,CAAC;0BAAE;;;;;;0BAGxG,6LAAC;gBAAO,SAAS,IAAM,OAAO;gBAAU,WAAW,GAAG,KAAK,uCAAuC,CAAC;0BAAE;;;;;;;;;;;;AAK3G;KA9BwB","debugId":null}},
    {"offset": {"line": 290, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app-1.2/components/UploadEvidence.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\n\nexport default function UploadEvidence({\n  listingId,\n  onUploaded,\n}: {\n  listingId: number;\n  onUploaded?: (url: string) => void;\n}) {\n  const [loading, setLoading] = useState(false);\n  const [url, setUrl] = useState<string | null>(null);\n\n  async function handleChange(e: React.ChangeEvent<HTMLInputElement>) {\n    const file = e.target.files?.[0];\n    if (!file) return;\n    setLoading(true);\n\n    // /api/uploads는 파일을 받아 업로드 후 { fileUrl }을 반환한다고 가정\n    const fd = new FormData();\n    fd.append(\"file\", file);\n    fd.append(\"listingId\", String(listingId));\n\n    const res = await fetch(\"/api/uploads\", { method: \"POST\", body: fd });\n    const json = await res.json();\n    setLoading(false);\n\n    if (!res.ok || !json?.fileUrl) {\n      alert(\"업로드 실패\");\n      return;\n    }\n    setUrl(json.fileUrl);\n    onUploaded?.(json.fileUrl);\n  }\n\n  return (\n    <div className=\"space-y-2\">\n      <label className=\"text-sm font-medium\">증빙 업로드</label>\n      <input type=\"file\" accept=\"image/*,application/pdf\" onChange={handleChange} />\n      {loading && <div className=\"text-xs text-neutral-500\">업로드 중…</div>}\n      {url && (\n        <a className=\"text-xs text-blue-600 underline\" href={url} target=\"_blank\">\n          업로드 완료: 보기\n        </a>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AAIe,SAAS,eAAe,EACrC,SAAS,EACT,UAAU,EAIX;;IACC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,yKAAQ,EAAgB;IAE9C,eAAe,aAAa,CAAsC;QAChE,MAAM,OAAO,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE;QAChC,IAAI,CAAC,MAAM;QACX,WAAW;QAEX,mDAAmD;QACnD,MAAM,KAAK,IAAI;QACf,GAAG,MAAM,CAAC,QAAQ;QAClB,GAAG,MAAM,CAAC,aAAa,OAAO;QAE9B,MAAM,MAAM,MAAM,MAAM,gBAAgB;YAAE,QAAQ;YAAQ,MAAM;QAAG;QACnE,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,WAAW;QAEX,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,SAAS;YAC7B,MAAM;YACN;QACF;QACA,OAAO,KAAK,OAAO;QACnB,aAAa,KAAK,OAAO;IAC3B;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAM,WAAU;0BAAsB;;;;;;0BACvC,6LAAC;gBAAM,MAAK;gBAAO,QAAO;gBAA0B,UAAU;;;;;;YAC7D,yBAAW,6LAAC;gBAAI,WAAU;0BAA2B;;;;;;YACrD,qBACC,6LAAC;gBAAE,WAAU;gBAAkC,MAAM;gBAAK,QAAO;0BAAS;;;;;;;;;;;;AAMlF;GA5CwB;KAAA","debugId":null}}]
}