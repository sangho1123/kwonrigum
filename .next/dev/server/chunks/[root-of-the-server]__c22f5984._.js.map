{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/shop-transfer-1.0/proxy.ts"],"sourcesContent":["// ... 상단 import 생략\n\nexport async function proxy(req: NextRequest) {\n  const { pathname } = req.nextUrl;\n\n  // 1. 정적 자원 및 인증/매물 API 무조건 통과\n  if (\n    pathname.startsWith(\"/_next\") || \n    pathname.startsWith(\"/api/auth\") ||\n    pathname.startsWith(\"/api/listings\") || // 매물 API 통과\n    pathname.includes(\".\")\n  ) {\n    return NextResponse.next();\n  }\n\n  // 2. 채팅 API도 미들웨어 단계에서는 통과 (내부 route.ts에서 auth()로 검증)\n  if (pathname.startsWith(\"/api/chat\")) {\n    return NextResponse.next();\n  }\n\n  const token = await getToken({ req, secret: process.env.NEXTAUTH_SECRET });\n\n  // 3. 공개 페이지 정의\n  const publicPaths = [\"/\", \"/login\", \"/register\", \"/listing\", \"/compare\", \"/calculator\"];\n  const isPublic = publicPaths.some(path => pathname === path || pathname.startsWith(\"/listing/\"));\n\n  // 4. 페이지 접근 제어 (API가 아닌 일반 페이지 이동 시에만 리다이렉트)\n  if (!isPublic && !token) {\n    const url = req.nextUrl.clone();\n    url.pathname = \"/login\";\n    url.searchParams.set(\"callbackUrl\", pathname);\n    return NextResponse.redirect(url);\n  }\n\n  return NextResponse.next();\n}"],"names":[],"mappings":"AAAA,mBAAmB;;;;;AAEZ,eAAe,MAAM,GAAgB;IAC1C,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAI,OAAO;IAEhC,8BAA8B;IAC9B,IACE,SAAS,UAAU,CAAC,aACpB,SAAS,UAAU,CAAC,gBACpB,SAAS,UAAU,CAAC,oBAAoB,YAAY;IACpD,SAAS,QAAQ,CAAC,MAClB;QACA,OAAO,aAAa,IAAI;IAC1B;IAEA,sDAAsD;IACtD,IAAI,SAAS,UAAU,CAAC,cAAc;QACpC,OAAO,aAAa,IAAI;IAC1B;IAEA,MAAM,QAAQ,MAAM,SAAS;QAAE;QAAK,QAAQ,QAAQ,GAAG,CAAC,eAAe;IAAC;IAExE,eAAe;IACf,MAAM,cAAc;QAAC;QAAK;QAAU;QAAa;QAAY;QAAY;KAAc;IACvF,MAAM,WAAW,YAAY,IAAI,CAAC,CAAA,OAAQ,aAAa,QAAQ,SAAS,UAAU,CAAC;IAEnF,6CAA6C;IAC7C,IAAI,CAAC,YAAY,CAAC,OAAO;QACvB,MAAM,MAAM,IAAI,OAAO,CAAC,KAAK;QAC7B,IAAI,QAAQ,GAAG;QACf,IAAI,YAAY,CAAC,GAAG,CAAC,eAAe;QACpC,OAAO,aAAa,QAAQ,CAAC;IAC/B;IAEA,OAAO,aAAa,IAAI;AAC1B","debugId":null}}]
}