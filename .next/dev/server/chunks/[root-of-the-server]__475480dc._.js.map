{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/shop-transfer-1.0/proxy.ts"],"sourcesContent":["import type { NextRequest } from \"next/server\";\nimport { NextResponse } from \"next/server\";\n// ✅ 아래 getToken 임포트가 반드시 있어야 합니다!\nimport { getToken } from \"next-auth/jwt\";\n\nexport async function proxy(req: NextRequest) {\n  const { pathname } = req.nextUrl;\n\n  // 1. 정적 자원 및 인증/매물 API 무조건 통과 (디자인 깨짐 방지)\n  if (\n    pathname.startsWith(\"/_next\") || \n    pathname.startsWith(\"/api/auth\") ||\n    pathname.startsWith(\"/api/listings\") ||\n    pathname.includes(\".\") ||\n    pathname === \"/favicon.ico\"\n  ) {\n    return NextResponse.next();\n  }\n\n  // 2. 채팅 API도 프록시 단계에서는 통과 (내부 route.ts에서 auth()로 검증)\n  if (pathname.startsWith(\"/api/chat\")) {\n    return NextResponse.next();\n  }\n\n  // 3. 토큰 확인 (로그인 여부)\n  const token = await getToken({ \n    req, \n    secret: process.env.NEXTAUTH_SECRET \n  });\n\n  // 4. 공개 페이지 정의\n  const publicPaths = [\"/\", \"/login\", \"/register\", \"/listing\", \"/compare\", \"/calculator\"];\n  const isPublic = publicPaths.some(path => \n    pathname === path || pathname.startsWith(\"/listing/\")\n  );\n\n  // 5. 비공개 페이지 보호 (토큰 없으면 로그인으로 리다이렉트)\n  if (!isPublic && !token) {\n    const url = req.nextUrl.clone();\n    url.pathname = \"/login\";\n    url.searchParams.set(\"callbackUrl\", pathname);\n    return NextResponse.redirect(url);\n  }\n\n  return NextResponse.next();\n}\n\nexport const config = {\n  matcher: [\"/((?!_next/static|_next/image|favicon.ico).*)\"],\n};"],"names":[],"mappings":";;;;;;AACA;AACA,kCAAkC;AAClC;AAAA;;;AAEO,eAAe,MAAM,GAAgB;IAC1C,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAI,OAAO;IAEhC,0CAA0C;IAC1C,IACE,SAAS,UAAU,CAAC,aACpB,SAAS,UAAU,CAAC,gBACpB,SAAS,UAAU,CAAC,oBACpB,SAAS,QAAQ,CAAC,QAClB,aAAa,gBACb;QACA,OAAO,8IAAY,CAAC,IAAI;IAC1B;IAEA,qDAAqD;IACrD,IAAI,SAAS,UAAU,CAAC,cAAc;QACpC,OAAO,8IAAY,CAAC,IAAI;IAC1B;IAEA,oBAAoB;IACpB,MAAM,QAAQ,MAAM,IAAA,iJAAQ,EAAC;QAC3B;QACA,QAAQ,QAAQ,GAAG,CAAC,eAAe;IACrC;IAEA,eAAe;IACf,MAAM,cAAc;QAAC;QAAK;QAAU;QAAa;QAAY;QAAY;KAAc;IACvF,MAAM,WAAW,YAAY,IAAI,CAAC,CAAA,OAChC,aAAa,QAAQ,SAAS,UAAU,CAAC;IAG3C,qCAAqC;IACrC,IAAI,CAAC,YAAY,CAAC,OAAO;QACvB,MAAM,MAAM,IAAI,OAAO,CAAC,KAAK;QAC7B,IAAI,QAAQ,GAAG;QACf,IAAI,YAAY,CAAC,GAAG,CAAC,eAAe;QACpC,OAAO,8IAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,OAAO,8IAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;KAAgD;AAC5D","debugId":null}}]
}