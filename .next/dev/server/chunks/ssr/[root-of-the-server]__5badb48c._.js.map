{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 24, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app%20v1.2/lib/db.ts"],"sourcesContent":["// lib/db.ts\nimport { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = globalThis as unknown as { prisma?: PrismaClient };\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: process.env.NODE_ENV === \"development\" ? [\"query\", \"error\", \"warn\"] : [\"error\"],\n  });\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":"AAAA,YAAY;;;;;AACZ;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;AAC7E;AAEF,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app%20v1.2/lib/auth.ts"],"sourcesContent":["// lib/auth.ts\nimport { prisma } from \"@/lib/db\";\nimport { compare } from \"bcryptjs\";\nimport NextAuth, { type NextAuthConfig } from \"next-auth\";\nimport Credentials from \"next-auth/providers/credentials\";\n\nexport const authOptions: NextAuthConfig = {\n  session: { strategy: \"jwt\" },\n  pages: { signIn: \"/login\" },\n  providers: [\n    Credentials({\n      name: \"Credentials\",\n      credentials: {\n        email: { label: \"이메일\", type: \"email\" },\n        password: { label: \"비밀번호\", type: \"password\" },\n      },\n      authorize: async (creds) => {\n        const email =\n          typeof creds?.email === \"string\" ? creds.email.trim().toLowerCase() : \"\";\n        const password =\n          typeof creds?.password === \"string\" ? creds.password.trim() : \"\";\n      \n        if (!email || !password) return null;\n      \n        const user = await prisma.user.findUnique({\n          where: { email },\n          select: { id: true, email: true, name: true, role: true, password: true },\n        });\n        if (!user || !user.password) return null;\n      \n        const ok = await compare(password, user.password);\n        if (!ok) return null;\n      \n        return {\n          id: user.id,\n          name: user.name ?? user.email,\n          email: user.email,\n          role: user.role,\n        } as any;\n      }\n    }),\n  ],\n  callbacks: {\n    async jwt({ token, user }: { token: import(\"next-auth/jwt\").JWT; user?: any }) {\n      if (user) {\n        token.id = user.id;\n        token.role = user.role;\n      }\n      return token;\n    },\n    async session({\n      session,\n      token,\n    }: {\n      session: import(\"next-auth\").Session;\n      token: import(\"next-auth/jwt\").JWT;\n    }) {\n      if (session.user) {\n        (session.user as any).id = token.id as string;\n        (session.user as any).role = token.role as string;\n      }\n      return session;\n    },\n  },\n};\n\nexport const { handlers, auth, signIn, signOut } = NextAuth(authOptions);\n"],"names":[],"mappings":"AAAA,cAAc;;;;;;;;;;;;;AACd;AACA;AACA;AACA;AAAA;;;;;AAEO,MAAM,cAA8B;IACzC,SAAS;QAAE,UAAU;IAAM;IAC3B,OAAO;QAAE,QAAQ;IAAS;IAC1B,WAAW;QACT,IAAA,qKAAW,EAAC;YACV,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAO,MAAM;gBAAQ;gBACrC,UAAU;oBAAE,OAAO;oBAAQ,MAAM;gBAAW;YAC9C;YACA,WAAW,OAAO;gBAChB,MAAM,QACJ,OAAO,OAAO,UAAU,WAAW,MAAM,KAAK,CAAC,IAAI,GAAG,WAAW,KAAK;gBACxE,MAAM,WACJ,OAAO,OAAO,aAAa,WAAW,MAAM,QAAQ,CAAC,IAAI,KAAK;gBAEhE,IAAI,CAAC,SAAS,CAAC,UAAU,OAAO;gBAEhC,MAAM,OAAO,MAAM,mHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;oBACxC,OAAO;wBAAE;oBAAM;oBACf,QAAQ;wBAAE,IAAI;wBAAM,OAAO;wBAAM,MAAM;wBAAM,MAAM;wBAAM,UAAU;oBAAK;gBAC1E;gBACA,IAAI,CAAC,QAAQ,CAAC,KAAK,QAAQ,EAAE,OAAO;gBAEpC,MAAM,KAAK,MAAM,IAAA,4IAAO,EAAC,UAAU,KAAK,QAAQ;gBAChD,IAAI,CAAC,IAAI,OAAO;gBAEhB,OAAO;oBACL,IAAI,KAAK,EAAE;oBACX,MAAM,KAAK,IAAI,IAAI,KAAK,KAAK;oBAC7B,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI;gBACjB;YACF;QACF;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAsD;YAC3E,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,KAAK,EAAE;gBAClB,MAAM,IAAI,GAAG,KAAK,IAAI;YACxB;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EACZ,OAAO,EACP,KAAK,EAIN;YACC,IAAI,QAAQ,IAAI,EAAE;gBACf,QAAQ,IAAI,CAAS,EAAE,GAAG,MAAM,EAAE;gBAClC,QAAQ,IAAI,CAAS,IAAI,GAAG,MAAM,IAAI;YACzC;YACA,OAAO;QACT;IACF;AACF;AAEO,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,GAAG,IAAA,gKAAQ,EAAC","debugId":null}},
    {"offset": {"line": 142, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app%20v1.2/app/listing/%5Bid%5D/page.tsx"],"sourcesContent":["// app/listing/[id]/page.tsx\nimport { auth } from \"@/lib/auth\";\nimport { prisma } from \"@/lib/db\";\nimport Link from \"next/link\";\nimport { notFound } from \"next/navigation\";\n\nexport default async function ListingDetailPage({\n  params,\n}: {\n  params: Promise<{ id: string }>;\n}) {\n  const { id } = await params;\n  const num = Number.parseInt(id, 10);\n  if (!Number.isFinite(num)) notFound();\n\n  const session = await auth();\n  const meId = (session?.user as any)?.id as string | undefined;\n  const myRole = (session?.user as any)?.role as \"ADMIN\" | \"CLIENT\" | undefined;\n\n  // ✅ 현재 Prisma 스키마에 존재하는 필드만 select\n  const item = await prisma.listing.findUnique({\n    where: { id: num },\n    select: {\n      id: true,\n      title: true,\n      category: true,\n      address_area: true,\n      rent_monthly: true,\n      deposit: true,\n      goodwill_price: true,\n      monthly_sales: true,\n      parking_spaces: true,\n      lat: true,\n      lng: true,\n      ownerId: true,\n      createdAt: true,\n    },\n  });\n\n  if (!item) notFound();\n\n  const canEdit = !!meId && (item.ownerId === meId || myRole === \"ADMIN\");\n  const fmt = (n?: number | null) =>\n    n == null ? \"-\" : new Intl.NumberFormat(\"ko-KR\").format(n);\n\n  return (\n    <main className=\"max-w-4xl mx-auto p-4 space-y-4\">\n      <header className=\"flex items-start justify-between gap-3\">\n        <div>\n          <h1 className=\"text-xl font-semibold\">{item.title}</h1>\n          {item.address_area && (\n            <div className=\"text-sm text-neutral-600\">{item.address_area}</div>\n          )}\n        </div>\n\n        {canEdit && (\n        <Link\n          href={`/listing/${item.id}/edit`}\n          prefetch={false}                     // ✅ 이 한 줄 추가\n          className=\"rounded-lg border px-3 py-1.5 text-sm hover:bg-neutral-50\"\n        >\n          수정\n        </Link>\n        )}\n      </header>\n\n      {/* 사진/미디어 필드는 스키마에 없으므로 일단 제거해 둡니다. */}\n\n      <section className=\"rounded-2xl border bg-white p-4\">\n        <div className=\"grid grid-cols-2 gap-x-8 gap-y-2 text-sm\">\n          <div>월세: {fmt(item.rent_monthly)}</div>\n          <div>임대보증금: {fmt(item.deposit)}</div>\n          <div>권리금: {fmt(item.goodwill_price)}</div>\n          <div>월매출: {fmt(item.monthly_sales)}</div>\n          <div>주차: {item.parking_spaces ?? 0}대</div>\n          <div>위치: {item.lat ?? \"-\"}, {item.lng ?? \"-\"}</div>\n        </div>\n      </section>\n    </main>\n  );\n}\n"],"names":[],"mappings":"AAAA,4BAA4B;;;;;;AAC5B;AACA;AACA;AACA;AAAA;;;;;;AAEe,eAAe,kBAAkB,EAC9C,MAAM,EAGP;IACC,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;IACrB,MAAM,MAAM,OAAO,QAAQ,CAAC,IAAI;IAChC,IAAI,CAAC,OAAO,QAAQ,CAAC,MAAM,IAAA,iMAAQ;IAEnC,MAAM,UAAU,MAAM,IAAA,mHAAI;IAC1B,MAAM,OAAQ,SAAS,MAAc;IACrC,MAAM,SAAU,SAAS,MAAc;IAEvC,mCAAmC;IACnC,MAAM,OAAO,MAAM,mHAAM,CAAC,OAAO,CAAC,UAAU,CAAC;QAC3C,OAAO;YAAE,IAAI;QAAI;QACjB,QAAQ;YACN,IAAI;YACJ,OAAO;YACP,UAAU;YACV,cAAc;YACd,cAAc;YACd,SAAS;YACT,gBAAgB;YAChB,eAAe;YACf,gBAAgB;YAChB,KAAK;YACL,KAAK;YACL,SAAS;YACT,WAAW;QACb;IACF;IAEA,IAAI,CAAC,MAAM,IAAA,iMAAQ;IAEnB,MAAM,UAAU,CAAC,CAAC,QAAQ,CAAC,KAAK,OAAO,KAAK,QAAQ,WAAW,OAAO;IACtE,MAAM,MAAM,CAAC,IACX,KAAK,OAAO,MAAM,IAAI,KAAK,YAAY,CAAC,SAAS,MAAM,CAAC;IAE1D,qBACE,8OAAC;QAAK,WAAU;;0BACd,8OAAC;gBAAO,WAAU;;kCAChB,8OAAC;;0CACC,8OAAC;gCAAG,WAAU;0CAAyB,KAAK,KAAK;;;;;;4BAChD,KAAK,YAAY,kBAChB,8OAAC;gCAAI,WAAU;0CAA4B,KAAK,YAAY;;;;;;;;;;;;oBAI/D,yBACD,8OAAC,0LAAI;wBACH,MAAM,CAAC,SAAS,EAAE,KAAK,EAAE,CAAC,KAAK,CAAC;wBAChC,UAAU;wBACV,WAAU;kCACX;;;;;;;;;;;;0BAQH,8OAAC;gBAAQ,WAAU;0BACjB,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;;gCAAI;gCAAK,IAAI,KAAK,YAAY;;;;;;;sCAC/B,8OAAC;;gCAAI;gCAAQ,IAAI,KAAK,OAAO;;;;;;;sCAC7B,8OAAC;;gCAAI;gCAAM,IAAI,KAAK,cAAc;;;;;;;sCAClC,8OAAC;;gCAAI;gCAAM,IAAI,KAAK,aAAa;;;;;;;sCACjC,8OAAC;;gCAAI;gCAAK,KAAK,cAAc,IAAI;gCAAE;;;;;;;sCACnC,8OAAC;;gCAAI;gCAAK,KAAK,GAAG,IAAI;gCAAI;gCAAG,KAAK,GAAG,IAAI;;;;;;;;;;;;;;;;;;;;;;;;AAKnD","debugId":null}}]
}