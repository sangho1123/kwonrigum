{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/shop-transfer-1.1/app/listing/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\n\nimport Image from \"next/image\";\nimport { useRouter } from \"next/navigation\";\nimport { use, useEffect, useState } from \"react\";\n\n// Í∏àÏï° Ìè¨Îß∑ÌåÖ Ìó¨Ìçº Ìï®Ïàò (ÎßåÏõê Îã®ÏúÑ Î≥ÄÌôò)\nconst formatMoney = (amount: number | null | undefined) => {\n  if (amount === null || amount === undefined) return \"Ï†ïÎ≥¥ ÏóÜÏùå\";\n  return `${(amount / 10000).toLocaleString()}ÎßåÏõê`;\n};\n\nexport default function ListingDetailPage({ params }: { params: Promise<{ id: string }> }) {\n  const router = useRouter();\n  const { id } = use(params);\n  const [listing, setListing] = useState<any>(null);\n\n  useEffect(() => {\n    async function fetchDetail() {\n      const res = await fetch(`/api/listings/${id}`);\n      if (res.ok) {\n        const data = await res.json();\n        \n        // üí° ÌïµÏã¨: DBÏóêÏÑú Ïò® photosÍ∞Ä Î¨∏ÏûêÏó¥(JSON)Ïù¥ÎùºÎ©¥ Î∞∞Ïó¥Î°ú Î≥ÄÌôò\n        if (typeof data.photos === \"string\") {\n          try {\n            data.photos = JSON.parse(data.photos);\n          } catch (e) {\n            console.error(\"ÏÇ¨ÏßÑ ÌååÏã± ÏóêÎü¨:\", e);\n            data.photos = [];\n          }\n        }\n        setListing(data);\n      }\n    }\n    fetchDetail();\n  }, [id]);\n\n  const startChat = async (type: string) => {\n    if (!listing) return;\n    const res = await fetch(\"/api/chat/threads\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ \n        type, \n        listingId: listing.id, \n        title: listing.title \n      }),\n    });\n\n    if (res.status === 401) {\n      router.push(`/login?callbackUrl=/listing/${id}`);\n      return;\n    }\n\n    const result = await res.json();\n    if (result.thread?.id) router.push(`/chat/${result.thread.id}`);\n  };\n\n  if (!listing) return <div className=\"p-20 text-center\">Î∂àÎü¨Ïò§Îäî Ï§ë...</div>;\n\n  // photosÍ∞Ä Î∞∞Ïó¥Ïù∏ÏßÄ ÏµúÏ¢Ö ÌôïÏù∏ (Í≤©Ïûê Î†àÏù¥ÏïÑÏõÉÏö©)\n  const photos = Array.isArray(listing.photos) ? listing.photos : [];\n\n  return (\n    <div className=\"min-h-screen bg-white\">\n      <div className=\"max-w-7xl mx-auto px-4 mt-6\">\n        {/* üì∏ ÏÇ¨ÏßÑ Í≤©Ïûê Î†àÏù¥ÏïÑÏõÉ */}\n        <div className=\"grid grid-cols-4 gap-2 h-[500px] overflow-hidden rounded-xl\">\n          {/* ÏôºÏ™Ω ÌÅ∞ ÏÇ¨ÏßÑ (0Î≤à) */}\n          <div className=\"col-span-2 relative h-full bg-gray-100\">\n            {photos[0] ? (\n              <Image src={photos[0]} alt=\"Î©îÏù∏\" fill className=\"object-cover\" />\n            ) : (\n              <div className=\"flex items-center justify-center h-full\">Ïù¥ÎØ∏ÏßÄ ÏóÜÏùå</div>\n            )}\n          </div>\n          \n          {/* Ïò§Î•∏Ï™Ω ÏûëÏùÄ ÏÇ¨ÏßÑ 4Í∞ú (1~4Î≤à) */}\n          <div className=\"col-span-2 grid grid-cols-2 grid-rows-2 gap-2 h-full\">\n            {[1, 2, 3, 4].map((i) => (\n              <div key={i} className=\"relative h-full bg-gray-100\">\n                {photos[i] && (\n                  <Image src={photos[i]} alt={`ÏÇ¨ÏßÑ ${i}`} fill className=\"object-cover\" />\n                )}\n              </div>\n            ))}\n          </div>\n        </div>\n\n        <div className=\"mt-8 grid grid-cols-1 md:grid-cols-3 gap-8 mb-20\">\n          <div className=\"col-span-2\">\n            <h1 className=\"text-4xl font-bold mb-4\">{listing.title}</h1>\n            <p className=\"text-xl text-gray-600 mb-6\">{listing.address_area}</p>\n            \n            <div className=\"border-t border-b py-8 my-8\">\n              <h2 className=\"text-2xl font-bold mb-4\">Îß§Î¨º ÏÑ§Î™Ö</h2>\n              <div className=\"text-gray-800 whitespace-pre-wrap leading-relaxed\">\n                {listing.description || \"ÏÑ§Î™ÖÏù¥ ÏóÜÏäµÎãàÎã§.\"}\n              </div>\n            </div>\n          </div>\n\n          <div className=\"col-span-1\">\n            <div className=\"sticky top-24 border p-6 rounded-2xl shadow-xl bg-white\">\n              {/* Í∞ÄÍ≤© Î∞è Îß§Ï∂ú Ï†ïÎ≥¥ ÏÑπÏÖò Ï∂îÍ∞Ä */}\n              <div className=\"space-y-5 mb-8\">\n                <div className=\"flex justify-between items-center border-b pb-4\">\n                  <span className=\"text-gray-500 font-medium\">Î≥¥Ï¶ùÍ∏à</span>\n                  <span className=\"text-xl font-bold text-gray-900\">{formatMoney(listing.deposit)}</span>\n                </div>\n                <div className=\"flex justify-between items-center border-b pb-4\">\n                  <span className=\"text-gray-500 font-medium\">ÏõîÏÑ∏</span>\n                  <span className=\"text-xl font-bold text-gray-900\">{formatMoney(listing.rent_monthly)}</span>\n                </div>\n                <div className=\"flex justify-between items-center border-b pb-4\">\n                  <span className=\"text-gray-500 font-medium\">Í∂åÎ¶¨Í∏à</span>\n                  <span className=\"text-xl font-bold text-gray-900\">{formatMoney(listing.goodwill_price)}</span>\n                </div>\n                <div className=\"flex justify-between items-center pt-2\">\n                  <span className=\"text-gray-500 font-medium\">Ïõî Îß§Ï∂ú</span>\n                  <span className=\"text-2xl font-bold text-blue-600\">{formatMoney(listing.monthly_sales)}</span>\n                </div>\n              </div>\n\n              <button \n                onClick={() => startChat(\"listing\")} \n                className=\"w-full bg-blue-600 hover:bg-blue-700 text-white py-4 rounded-xl font-bold text-lg transition-colors\"\n              >\n                Ïã§ÏãúÍ∞Ñ Ï±ÑÌåÖ Î¨∏ÏùòÌïòÍ∏∞\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}