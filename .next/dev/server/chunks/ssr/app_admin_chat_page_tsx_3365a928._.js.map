{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/shop-transfer-1.0/app/admin/chat/page.tsx"],"sourcesContent":["// app/admin/chat/page.tsx\n\"use client\";\n\nimport Link from \"next/link\";\nimport useSWR from \"swr\";\n\ntype Row = {\n  id: string;\n  type: \"listing\" | \"loan\" | \"fitout\" | string;\n  listingId: number | null;\n  title: string | null;\n  createdAt: string;\n  lastAt: string | null;\n  lastText: string | null;\n  messageCount: number;\n  unreadAdmin: boolean;\n  unreadUser: boolean;\n};\n\nconst fetcher = (url: string) =>\n  fetch(url, { cache: \"no-store\" }).then((r) => r.json());\n\nfunction timeago(iso?: string | null) {\n  if (!iso) return \"-\";\n  const d = new Date(iso).getTime();\n  const diff = Date.now() - d;\n  const m = Math.floor(diff / 60000);\n  if (m < 1) return \"방금\";\n  if (m < 60) return `${m}분`;\n  const h = Math.floor(m / 60);\n  if (h < 24) return `${h}시간`;\n  const dday = Math.floor(h / 24);\n  return `${dday}일`;\n}\n\nexport default function AdminChatList() {\n  const { data, isLoading } = useSWR<{ ok: boolean; items: Row[] }>(\n    \"/api/chat/threads\",\n    fetcher,\n    { refreshInterval: 3000 }\n  );\n\n  const rows = data?.items ?? [];\n\n  return (\n    <main className=\"max-w-4xl mx-auto p-6\">\n      <h1 className=\"text-lg font-semibold mb-4\">채팅(관리자)</h1>\n\n      <div className=\"rounded-2xl border overflow-hidden bg-white\">\n        <table className=\"w-full text-sm\">\n          <thead className=\"bg-neutral-50 text-neutral-600\">\n            <tr>\n              <th className=\"text-left px-3 py-2 w-12\">상태</th>\n              <th className=\"text-left px-3 py-2\">제목</th>\n              <th className=\"text-left px-3 py-2 w-28\">유형</th>\n              <th className=\"text-left px-3 py-2 w-24\">매물ID</th>\n              <th className=\"text-left px-3 py-2 w-40\">최근</th>\n              <th className=\"text-right px-3 py-2 w-24\">메시지</th>\n              <th className=\"px-3 py-2 w-24\">열기</th>\n            </tr>\n          </thead>\n          <tbody>\n            {isLoading && rows.length === 0 ? (\n              <tr>\n                <td colSpan={7} className=\"px-3 py-6 text-center text-neutral-500\">\n                  목록을 불러오는 중…\n                </td>\n              </tr>\n            ) : rows.length === 0 ? (\n              <tr>\n                <td colSpan={7} className=\"px-3 py-6 text-center text-neutral-500\">\n                  대화가 없습니다.\n                </td>\n              </tr>\n            ) : (\n              rows.map((r) => (\n                <tr\n                  key={r.id}\n                  className=\"border-t hover:bg-neutral-50 transition-colors\"\n                >\n                  <td className=\"px-3 py-2\">\n                    {r.unreadAdmin ? (\n                      <span className=\"inline-flex w-2.5 h-2.5 rounded-full bg-sky-500\" title=\"안읽음\" />\n                    ) : (\n                      <span className=\"inline-flex w-2.5 h-2.5 rounded-full bg-neutral-300\" title=\"읽음\" />\n                    )}\n                  </td>\n                  <td className=\"px-3 py-2\">\n                    <div className=\"font-medium\">\n                      {r.title ?? \"(제목 없음)\"}\n                    </div>\n                    <div className=\"text-xs text-neutral-500 line-clamp-1\">\n                      {r.lastText ?? \"-\"}\n                    </div>\n                  </td>\n                  <td className=\"px-3 py-2\">{r.type}</td>\n                  <td className=\"px-3 py-2\">{r.listingId ?? \"-\"}</td>\n                  <td className=\"px-3 py-2\">\n                    {r.lastAt ? `${timeago(r.lastAt)} 전` : \"-\"}\n                  </td>\n                  <td className=\"px-3 py-2 text-right\">{r.messageCount}</td>\n                  <td className=\"px-3 py-2 text-center\">\n                    <Link\n                      href={`/chat/${r.id}?role=admin`}\n                      className=\"rounded-lg border px-3 py-1.5 hover:bg-neutral-100\"\n                      title=\"채팅 열기\"\n                    >\n                      열기\n                    </Link>\n                  </td>\n                </tr>\n              ))\n            )}\n          </tbody>\n        </table>\n      </div>\n    </main>\n  );\n}\n"],"names":[],"mappings":"AAAA,0BAA0B;;;;;;AAG1B;AACA;AAHA;;;;AAkBA,MAAM,UAAU,CAAC,MACf,MAAM,KAAK;QAAE,OAAO;IAAW,GAAG,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI;AAEtD,SAAS,QAAQ,GAAmB;IAClC,IAAI,CAAC,KAAK,OAAO;IACjB,MAAM,IAAI,IAAI,KAAK,KAAK,OAAO;IAC/B,MAAM,OAAO,KAAK,GAAG,KAAK;IAC1B,MAAM,IAAI,KAAK,KAAK,CAAC,OAAO;IAC5B,IAAI,IAAI,GAAG,OAAO;IAClB,IAAI,IAAI,IAAI,OAAO,GAAG,EAAE,CAAC,CAAC;IAC1B,MAAM,IAAI,KAAK,KAAK,CAAC,IAAI;IACzB,IAAI,IAAI,IAAI,OAAO,GAAG,EAAE,EAAE,CAAC;IAC3B,MAAM,OAAO,KAAK,KAAK,CAAC,IAAI;IAC5B,OAAO,GAAG,KAAK,CAAC,CAAC;AACnB;AAEe,SAAS;IACtB,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,IAAA,yKAAM,EAChC,qBACA,SACA;QAAE,iBAAiB;IAAK;IAG1B,MAAM,OAAO,MAAM,SAAS,EAAE;IAE9B,qBACE,8OAAC;QAAK,WAAU;;0BACd,8OAAC;gBAAG,WAAU;0BAA6B;;;;;;0BAE3C,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAM,WAAU;;sCACf,8OAAC;4BAAM,WAAU;sCACf,cAAA,8OAAC;;kDACC,8OAAC;wCAAG,WAAU;kDAA2B;;;;;;kDACzC,8OAAC;wCAAG,WAAU;kDAAsB;;;;;;kDACpC,8OAAC;wCAAG,WAAU;kDAA2B;;;;;;kDACzC,8OAAC;wCAAG,WAAU;kDAA2B;;;;;;kDACzC,8OAAC;wCAAG,WAAU;kDAA2B;;;;;;kDACzC,8OAAC;wCAAG,WAAU;kDAA4B;;;;;;kDAC1C,8OAAC;wCAAG,WAAU;kDAAiB;;;;;;;;;;;;;;;;;sCAGnC,8OAAC;sCACE,aAAa,KAAK,MAAM,KAAK,kBAC5B,8OAAC;0CACC,cAAA,8OAAC;oCAAG,SAAS;oCAAG,WAAU;8CAAyC;;;;;;;;;;uCAInE,KAAK,MAAM,KAAK,kBAClB,8OAAC;0CACC,cAAA,8OAAC;oCAAG,SAAS;oCAAG,WAAU;8CAAyC;;;;;;;;;;uCAKrE,KAAK,GAAG,CAAC,CAAC,kBACR,8OAAC;oCAEC,WAAU;;sDAEV,8OAAC;4CAAG,WAAU;sDACX,EAAE,WAAW,iBACZ,8OAAC;gDAAK,WAAU;gDAAkD,OAAM;;;;;qEAExE,8OAAC;gDAAK,WAAU;gDAAsD,OAAM;;;;;;;;;;;sDAGhF,8OAAC;4CAAG,WAAU;;8DACZ,8OAAC;oDAAI,WAAU;8DACZ,EAAE,KAAK,IAAI;;;;;;8DAEd,8OAAC;oDAAI,WAAU;8DACZ,EAAE,QAAQ,IAAI;;;;;;;;;;;;sDAGnB,8OAAC;4CAAG,WAAU;sDAAa,EAAE,IAAI;;;;;;sDACjC,8OAAC;4CAAG,WAAU;sDAAa,EAAE,SAAS,IAAI;;;;;;sDAC1C,8OAAC;4CAAG,WAAU;sDACX,EAAE,MAAM,GAAG,GAAG,QAAQ,EAAE,MAAM,EAAE,EAAE,CAAC,GAAG;;;;;;sDAEzC,8OAAC;4CAAG,WAAU;sDAAwB,EAAE,YAAY;;;;;;sDACpD,8OAAC;4CAAG,WAAU;sDACZ,cAAA,8OAAC,uKAAI;gDACH,MAAM,CAAC,MAAM,EAAE,EAAE,EAAE,CAAC,WAAW,CAAC;gDAChC,WAAU;gDACV,OAAM;0DACP;;;;;;;;;;;;mCA7BE,EAAE,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyC3B","debugId":null}}]
}