{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 24, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app%20v1.2/lib/db.ts"],"sourcesContent":["// lib/db.ts\nimport { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = globalThis as unknown as { prisma?: PrismaClient };\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: process.env.NODE_ENV === \"development\" ? [\"query\", \"error\", \"warn\"] : [\"error\"],\n  });\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":"AAAA,YAAY;;;;;AACZ;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;AAC7E;AAEF,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 44, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app%20v1.2/lib/mockData.ts"],"sourcesContent":["// lib/mockData.ts\n\nexport type Listing = {\n  id: number;\n  title: string;\n  category: string;      // 업종\n  gu: string;            // 구\n  dong: string;          // 동\n  address_area: string;  // 표시용\n  lat: number;\n  lng: number;\n\n  rent_monthly?: number;     // 월세\n  deposit?: number;          // 임대보증금\n  goodwill_price?: number;   // 권리금\n  monthly_sales?: number;    // 월매출\n  parking_spaces?: number;   // 주차 가능 대수\n\n  photos?: string[];         // 상세/목록 사진 (public 기준 경로)\n  verification_status?: \"verified\" | \"unverified\";\n};\n\nexport const listings: Listing[] = [\n  {\n    id: 45,\n    title: \"논현동 소형 카페\",\n    category: \"카페/디저트\",\n    gu: \"강남구\",\n    dong: \"논현동\",\n    address_area: \"강남구 논현동\",\n    lat: 37.512345,\n    lng: 127.032198,\n    rent_monthly: 3_800_000,\n    deposit: 30_000_000,\n    goodwill_price: 50_000_000,\n    monthly_sales: 35_000_000,\n    parking_spaces: 1,\n    photos: [\"/photos/coffee.jpg\"],\n    verification_status: \"unverified\",\n  },\n  {\n    id: 47,\n    title: \"봉천동 치킨 전문\",\n    category: \"치킨\",\n    gu: \"관악구\",\n    dong: \"봉천동\",\n    address_area: \"관악구 봉천동\",\n    lat: 37.485555,\n    lng: 126.955,\n    rent_monthly: 2_500_000,\n    deposit: 20_000_000,\n    goodwill_price: 0,\n    monthly_sales: 28_000_000,\n    parking_spaces: 0,\n    photos: [\"/photos/chicken.jpg\"],\n    verification_status: \"unverified\",\n  },\n];\n"],"names":[],"mappings":"AAAA,kBAAkB;;;;;AAsBX,MAAM,WAAsB;IACjC;QACE,IAAI;QACJ,OAAO;QACP,UAAU;QACV,IAAI;QACJ,MAAM;QACN,cAAc;QACd,KAAK;QACL,KAAK;QACL,cAAc;QACd,SAAS;QACT,gBAAgB;QAChB,eAAe;QACf,gBAAgB;QAChB,QAAQ;YAAC;SAAqB;QAC9B,qBAAqB;IACvB;IACA;QACE,IAAI;QACJ,OAAO;QACP,UAAU;QACV,IAAI;QACJ,MAAM;QACN,cAAc;QACd,KAAK;QACL,KAAK;QACL,cAAc;QACd,SAAS;QACT,gBAAgB;QAChB,eAAe;QACf,gBAAgB;QAChB,QAAQ;YAAC;SAAsB;QAC/B,qBAAqB;IACvB;CACD","debugId":null}},
    {"offset": {"line": 93, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app%20v1.2/app/listing/%5Bid%5D/page.tsx"],"sourcesContent":["// app/listing/[id]/page.tsx\nimport { prisma } from \"@/lib/db\";\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport { notFound } from \"next/navigation\";\n\n// mockData 폴백용\nimport * as mock from \"@/lib/mockData\";\n\nexport default async function ListingDetailPage({\n  params,\n}: {\n  params: Promise<{ id: string }>;\n}) {\n  const { id } = await params;\n  const num = Number(id);\n  if (!Number.isFinite(num)) notFound();\n\n  // 세션은 선택사항(권한 체크용) – 에러나면 무시\n  let meId: string | undefined;\n  let myRole: \"ADMIN\" | \"CLIENT\" | undefined;\n  try {\n    const { auth } = await import(\"@/lib/auth\");\n    const session = await auth().catch(() => null);\n    meId = (session?.user as any)?.id;\n    myRole = (session?.user as any)?.role;\n  } catch {}\n\n  // 1) DB에서 먼저 시도\n  let item:\n    | (awaitedReturn<typeof prisma.listing.findUnique>)\n    | null = null;\n\n  try {\n    item = await prisma.listing.findUnique({\n      where: { id: num },\n      select: {\n        id: true,\n        title: true,\n        category: true,\n        address_area: true,\n        address_full: true,\n        lat: true,\n        lng: true,\n        rent_monthly: true,\n        deposit: true,\n        goodwill_price: true,\n        monthly_sales: true,\n        parking_spaces: true,\n        ownerId: true,\n        photos: true as any, // JSON/array 호환\n        media: {\n          where: { is_public: true, file_type: \"photo\" } as any,\n          select: { file_url: true } as any,\n        } as any,\n      },\n    });\n  } catch {\n    // prisma 미정비여도 폴백으로 이어감\n  }\n\n  // 2) DB 없으면 mock으로 폴백\n  let fromMock = false;\n  let title = item?.title ?? \"\";\n  let category = item?.category ?? \"\";\n  let address_area = item?.address_area ?? \"\";\n  let lat = item?.lat ?? null;\n  let lng = item?.lng ?? null;\n  let rent_monthly = item?.rent_monthly ?? null;\n  let deposit = item?.deposit ?? null;\n  let goodwill_price = item?.goodwill_price ?? null;\n  let monthly_sales = item?.monthly_sales ?? null;\n  let parking_spaces = item?.parking_spaces ?? null;\n  let ownerId = item?.ownerId ?? null;\n\n  let photos: string[] =\n    Array.isArray(item?.photos)\n      ? (item!.photos as string[])\n      : Array.isArray(item?.media)\n      ? (item!.media as Array<{ file_url: string }>).map((m) => m.file_url)\n      : [];\n\n  if (!item) {\n    const mockOne = (mock as any).listings?.find((x: any) => x.id === num);\n    if (!mockOne) notFound();\n\n    fromMock = true;\n    title = mockOne.title ?? \"(제목 없음)\";\n    category = mockOne.category ?? \"\";\n    address_area = mockOne.address_area ?? \"\";\n    lat = mockOne.lat ?? null;\n    lng = mockOne.lng ?? null;\n    rent_monthly = mockOne.rent_monthly ?? null;\n    deposit = mockOne.deposit ?? null;\n    goodwill_price = mockOne.goodwill_price ?? null;\n    monthly_sales = mockOne.monthly_sales ?? null;\n    parking_spaces = mockOne.parking_spaces ?? null;\n\n    const media = Array.isArray(mockOne.media)\n      ? mockOne.media\n          .filter((m: any) => m.file_type === \"photo\")\n          .map((m: any) => m.file_url)\n      : [];\n    photos = [\n      ...(mockOne.thumbnail_url ? [mockOne.thumbnail_url] : []),\n      ...media,\n    ];\n  }\n\n  const canEdit = !fromMock && !!meId && (ownerId === meId || myRole === \"ADMIN\");\n  const fmt = (n?: number | null) =>\n    n == null ? \"-\" : new Intl.NumberFormat(\"ko-KR\").format(n);\n\n  return (\n    <main className=\"max-w-4xl mx-auto p-4 space-y-4\">\n      <header className=\"flex items-start justify-between gap-3\">\n        <div>\n          <h1 className=\"text-xl font-semibold\">{title || \"(제목 없음)\"}</h1>\n          {address_area && (\n            <div className=\"text-sm text-neutral-600\">{address_area}</div>\n          )}\n        </div>\n        {canEdit && (\n          <Link\n            href={`/listing/${num}/edit`}\n            className=\"rounded-lg border px-3 py-1.5 text-sm hover:bg-neutral-50\"\n          >\n            수정\n          </Link>\n        )}\n      </header>\n\n      {photos.length > 0 && (\n        <div className=\"grid grid-cols-2 gap-3\">\n          {photos.slice(0, 2).map((src, i) => (\n            <div\n              key={i}\n              className=\"relative aspect-[4/3] rounded-xl overflow-hidden border bg-neutral-100\"\n            >\n              <Image\n                src={src}\n                alt={`photo-${i}`}\n                fill\n                sizes=\"(max-width: 768px) 100vw, 50vw\"\n                style={{ objectFit: \"cover\" }}\n              />\n            </div>\n          ))}\n        </div>\n      )}\n\n      <section className=\"rounded-2xl border bg-white p-4\">\n        <div className=\"grid grid-cols-2 gap-x-8 gap-y-2 text-sm\">\n          <div>월세: {fmt(rent_monthly)}</div>\n          <div>임대보증금: {fmt(deposit)}</div>\n          <div>권리금: {fmt(goodwill_price)}</div>\n          <div>월매출: {fmt(monthly_sales)}</div>\n          <div>주차: {parking_spaces ?? 0}대</div>\n          <div>\n            좌표: {lat ?? \"-\"}, {lng ?? \"-\"}\n          </div>\n        </div>\n      </section>\n    </main>\n  );\n}\n\n// 타입 유틸(간단)\ntype awaitedReturn<T> = T extends Promise<infer U> ? U : T;\n"],"names":[],"mappings":"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","debugId":null}}]
}