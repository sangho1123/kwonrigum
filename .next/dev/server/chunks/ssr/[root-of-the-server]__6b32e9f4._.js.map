{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 24, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/shop-transfer-1.0/lib/db.ts"],"sourcesContent":["// lib/db.ts\nimport { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = globalThis as unknown as { prisma?: PrismaClient };\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: process.env.NODE_ENV === \"development\" ? [\"query\", \"error\", \"warn\"] : [\"error\"],\n  });\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":"AAAA,YAAY;;;;;AACZ;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;AAC7E;AAEF,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/shop-transfer-1.0/lib/auth.ts"],"sourcesContent":["// lib/auth.ts\nimport { prisma } from \"@/lib/db\";\nimport { compare } from \"bcryptjs\";\nimport NextAuth, { type NextAuthConfig } from \"next-auth\";\nimport Credentials from \"next-auth/providers/credentials\";\n\nexport const authOptions: NextAuthConfig = {\n  session: { strategy: \"jwt\" },\n  pages: { signIn: \"/login\" },\n  providers: [\n    Credentials({\n      name: \"Credentials\",\n      credentials: {\n        email: { label: \"Ïù¥Î©îÏùº\", type: \"email\" },\n        password: { label: \"ÎπÑÎ∞ÄÎ≤àÌò∏\", type: \"password\" },\n      },\n      authorize: async (creds) => {\n        const email =\n          typeof creds?.email === \"string\" ? creds.email.trim().toLowerCase() : \"\";\n        const password =\n          typeof creds?.password === \"string\" ? creds.password.trim() : \"\";\n      \n        if (!email || !password) return null;\n      \n        const user = await prisma.user.findUnique({\n          where: { email },\n          select: { id: true, email: true, name: true, role: true, password: true },\n        });\n        if (!user || !user.password) return null;\n      \n        const ok = await compare(password, user.password);\n        if (!ok) return null;\n      \n        return {\n          id: user.id,\n          name: user.name ?? user.email,\n          email: user.email,\n          role: user.role,\n        } as any;\n      }\n    }),\n  ],\n  callbacks: {\n    async jwt({ token, user }: { token: import(\"next-auth/jwt\").JWT; user?: any }) {\n      if (user) {\n        token.id = user.id;\n        token.role = user.role;\n      }\n      return token;\n    },\n    async session({\n      session,\n      token,\n    }: {\n      session: import(\"next-auth\").Session;\n      token: import(\"next-auth/jwt\").JWT;\n    }) {\n      if (session.user) {\n        (session.user as any).id = token.id as string;\n        (session.user as any).role = token.role as string;\n      }\n      return session;\n    },\n  },\n};\n\nexport const { handlers, auth, signIn, signOut } = NextAuth(authOptions);\n"],"names":[],"mappings":"AAAA,cAAc;;;;;;;;;;;;;AACd;AACA;AACA;AACA;AAAA;;;;;AAEO,MAAM,cAA8B;IACzC,SAAS;QAAE,UAAU;IAAM;IAC3B,OAAO;QAAE,QAAQ;IAAS;IAC1B,WAAW;QACT,IAAA,qKAAW,EAAC;YACV,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAO,MAAM;gBAAQ;gBACrC,UAAU;oBAAE,OAAO;oBAAQ,MAAM;gBAAW;YAC9C;YACA,WAAW,OAAO;gBAChB,MAAM,QACJ,OAAO,OAAO,UAAU,WAAW,MAAM,KAAK,CAAC,IAAI,GAAG,WAAW,KAAK;gBACxE,MAAM,WACJ,OAAO,OAAO,aAAa,WAAW,MAAM,QAAQ,CAAC,IAAI,KAAK;gBAEhE,IAAI,CAAC,SAAS,CAAC,UAAU,OAAO;gBAEhC,MAAM,OAAO,MAAM,mHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;oBACxC,OAAO;wBAAE;oBAAM;oBACf,QAAQ;wBAAE,IAAI;wBAAM,OAAO;wBAAM,MAAM;wBAAM,MAAM;wBAAM,UAAU;oBAAK;gBAC1E;gBACA,IAAI,CAAC,QAAQ,CAAC,KAAK,QAAQ,EAAE,OAAO;gBAEpC,MAAM,KAAK,MAAM,IAAA,4IAAO,EAAC,UAAU,KAAK,QAAQ;gBAChD,IAAI,CAAC,IAAI,OAAO;gBAEhB,OAAO;oBACL,IAAI,KAAK,EAAE;oBACX,MAAM,KAAK,IAAI,IAAI,KAAK,KAAK;oBAC7B,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI;gBACjB;YACF;QACF;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAsD;YAC3E,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,KAAK,EAAE;gBAClB,MAAM,IAAI,GAAG,KAAK,IAAI;YACxB;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EACZ,OAAO,EACP,KAAK,EAIN;YACC,IAAI,QAAQ,IAAI,EAAE;gBACf,QAAQ,IAAI,CAAS,EAAE,GAAG,MAAM,EAAE;gBAClC,QAAQ,IAAI,CAAS,IAAI,GAAG,MAAM,IAAI;YACzC;YACA,OAAO;QACT;IACF;AACF;AAEO,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,GAAG,IAAA,gKAAQ,EAAC","debugId":null}},
    {"offset": {"line": 142, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/shop-transfer-1.0/app/listing/mine/page.tsx"],"sourcesContent":["// app/listing/mine/page.tsx\nimport { auth } from \"@/lib/auth\";\nimport { prisma } from \"@/lib/db\";\nimport Link from \"next/link\";\nimport { redirect } from \"next/navigation\";\n\nexport const dynamic = \"force-dynamic\";\n\nconst fmt = (n?: number | null) =>\n  n == null ? \"-\" : new Intl.NumberFormat(\"ko-KR\").format(n);\n\nexport default async function MyListingsPage() {\n  const session = await auth();\n  const meId = (session?.user as any)?.id as string | undefined;\n\n  // Î°úÍ∑∏Ïù∏ Ïïà ÎêòÏñ¥ ÏûàÏúºÎ©¥ Î°úÍ∑∏Ïù∏ ÌéòÏù¥ÏßÄÎ°ú Î≥¥ÎÉÑ\n  if (!meId) {\n    redirect(\"/login\");\n  }\n\n  // ÎÇ¥Í∞Ä Ïò¨Î¶∞ Îß§Î¨ºÎßå Ï°∞Ìöå\n  const rows = await prisma.listing.findMany({\n    where: { ownerId: meId },\n    orderBy: { createdAt: \"desc\" },\n    select: {\n      id: true,\n      title: true,\n      address_area: true,\n      deposit: true,\n      rent_monthly: true,\n      goodwill_price: true,\n      createdAt: true,\n    },\n  });\n\n  // --- Î¶¨Îìú Í∞úÏàò ÏßëÍ≥Ñ (Prisma Lead ÌÖåÏù¥Î∏î Í∏∞Ï§Ä) ---\n  const listingIds = rows.map((x) => x.id);\n\n  let leadCountByListing: Record<number, number> = {};\n\n  if (listingIds.length > 0) {\n    const leads = await prisma.lead.findMany({\n      where: {\n        listingId: { in: listingIds },\n      },\n      select: {\n        listingId: true,\n      },\n    });\n\n    for (const l of leads) {\n      if (l.listingId == null) continue;\n      leadCountByListing[l.listingId] =\n        (leadCountByListing[l.listingId] ?? 0) + 1;\n    }\n  }\n\n  return (\n    <main className=\"max-w-4xl mx-auto p-6 space-y-4\">\n      <header className=\"flex items-center justify-between gap-2\">\n        <div>\n          <h1 className=\"text-xl font-semibold\">ÎÇ¥ Îß§Î¨º</h1>\n          <p className=\"text-sm text-neutral-600\">\n            ÌòÑÏû¨ Î°úÍ∑∏Ïù∏Ìïú Í≥ÑÏ†ïÏúºÎ°ú Îì±Î°ùÌïú Îß§Î¨º Î™©Î°ùÏûÖÎãàÎã§.\n          </p>\n        </div>\n        <Link\n          href=\"/listing/new\"\n          className=\"rounded-lg bg-sky-600 hover:bg-sky-700 text-white text-sm px-3 py-1.5\"\n        >\n          ÏÉà Îß§Î¨º Îì±Î°ù\n        </Link>\n      </header>\n\n      {rows.length === 0 ? (\n        <div className=\"rounded-lg border bg-white p-4 text-sm text-neutral-600\">\n          ÏïÑÏßÅ Îì±Î°ùÎêú Îß§Î¨ºÏù¥ ÏóÜÏäµÎãàÎã§.{\" \"}\n          <Link href=\"/listing/new\" className=\"underline\">\n            Ï≤´ Îß§Î¨ºÏùÑ Îì±Î°ùÌï¥ Î≥¥ÏÑ∏Ïöî.\n          </Link>\n        </div>\n      ) : (\n        <div className=\"border rounded-lg overflow-hidden bg-white\">\n          <table className=\"w-full text-sm\">\n            <thead className=\"bg-neutral-50\">\n              <tr>\n                <th className=\"px-3 py-2 text-left w-16\">ID</th>\n                <th className=\"px-3 py-2 text-left\">Ï†úÎ™©</th>\n                <th className=\"px-3 py-2 text-left w-40\">ÏßÄÏó≠</th>\n                <th className=\"px-3 py-2 text-right w-32\">Î≥¥Ï¶ùÍ∏à</th>\n                <th className=\"px-3 py-2 text-right w-32\">ÏõîÏÑ∏</th>\n                <th className=\"px-3 py-2 text-right w-32\">Í∂åÎ¶¨Í∏à</th>\n                <th className=\"px-3 py-2 text-right w-24\">Î¶¨Îìú</th>\n                <th className=\"px-3 py-2 text-left w-40\">Îì±Î°ùÏùº</th>\n                <th className=\"px-3 py-2 text-left w-24\"></th>\n              </tr>\n            </thead>\n            <tbody>\n              {rows.map((x) => {\n                const leadCount = leadCountByListing[x.id] ?? 0;\n                return (\n                  <tr key={x.id} className=\"border-t\">\n                    <td className=\"px-3 py-2 align-top\">{x.id}</td>\n                    <td className=\"px-3 py-2 align-top\">\n                      <Link\n                        href={`/listing/${x.id}`}\n                        className=\"underline underline-offset-2 hover:text-sky-700\"\n                      >\n                        {x.title || \"(Ï†úÎ™© ÏóÜÏùå)\"}\n                      </Link>\n                    </td>\n                    <td className=\"px-3 py-2 align-top text-neutral-700\">\n                      {x.address_area || \"-\"}\n                    </td>\n                    <td className=\"px-3 py-2 align-top text-right\">\n                      {fmt(x.deposit)}\n                    </td>\n                    <td className=\"px-3 py-2 align-top text-right\">\n                      {fmt(x.rent_monthly)}\n                    </td>\n                    <td className=\"px-3 py-2 align-top text-right\">\n                      {fmt(x.goodwill_price)}\n                    </td>\n                    <td className=\"px-3 py-2 align-top text-right\">\n                      {leadCount > 0 ? (\n                        // üî• Ïó¨Í∏∞Îßå Link ‚Üí a Î°ú Î∞îÍøîÏÑú Î¨¥Ï°∞Í±¥ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò ÎêòÍ≤å\n                        <a\n                          href={`/listing/${x.id}/leads`}\n                          className=\"inline-flex items-center justify-center min-w-[2rem] rounded-full bg-sky-50 text-sky-700 border border-sky-100 px-2 py-0.5 text-xs hover:bg-sky-100\"\n                        >\n                          {leadCount}\n                        </a>\n                      ) : (\n                        <span className=\"text-neutral-400\">0</span>\n                      )}\n                    </td>\n                    <td className=\"px-3 py-2 align-top text-neutral-600\">\n                      {new Date(x.createdAt).toLocaleDateString(\"ko-KR\")}\n                    </td>\n                    <td className=\"px-3 py-2 align-top\">\n                      <Link\n                        href={`/listing/${x.id}/edit`}\n                        className=\"text-xs rounded border px-2 py-1 hover:bg-neutral-50\"\n                      >\n                        ÏàòÏ†ï\n                      </Link>\n                    </td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </div>\n      )}\n    </main>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}