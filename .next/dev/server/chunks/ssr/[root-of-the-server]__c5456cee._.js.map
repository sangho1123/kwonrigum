{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 24, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app%20v1.2/lib/db.ts"],"sourcesContent":["// lib/db.ts\nimport { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = globalThis as unknown as { prisma?: PrismaClient };\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: process.env.NODE_ENV === \"development\" ? [\"query\", \"error\", \"warn\"] : [\"error\"],\n  });\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":"AAAA,YAAY;;;;;AACZ;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;AAC7E;AAEF,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app%20v1.2/lib/auth.ts"],"sourcesContent":["// lib/auth.ts  (v4 호환 버전)\nimport { prisma } from \"@/lib/db\";\nimport { compare } from \"bcryptjs\";\nimport type { NextAuthOptions } from \"next-auth\";\nimport { getServerSession } from \"next-auth\";\nimport CredentialsProvider from \"next-auth/providers/credentials\";\n\nexport const authOptions: NextAuthOptions = {\n  session: { strategy: \"jwt\" },\n  providers: [\n    CredentialsProvider({\n      name: \"credentials\",\n      credentials: {\n        email: { label: \"email\", type: \"text\" },\n        password: { label: \"password\", type: \"password\" },\n      },\n      async authorize(credentials) {\n        const email = credentials?.email?.trim().toLowerCase() || \"\";\n        const password = credentials?.password || \"\";\n\n        const user = await prisma.user.findUnique({\n          where: { email },\n          select: { id: true, email: true, name: true, role: true, password: true },\n        });\n        if (!user) return null;\n\n        const ok = await compare(password, user.password);\n        if (!ok) return null;\n\n        return { id: user.id, email: user.email, name: user.name, role: user.role as any };\n      },\n    }),\n  ],\n  callbacks: {\n    async jwt({ token, user }) {\n      if (user) {\n        token.role = (user as any).role;\n      }\n      return token;\n    },\n    async session({ session, token }) {\n      if (session.user) {\n        (session.user as any).role = token.role;\n      }\n      return session;\n    },\n  },\n};\n\n// 서버 컴포넌트/route에서 세션 가져올 때 사용\nexport function auth() {\n  return getServerSession(authOptions);\n}\n\n// 클라이언트 훅/액션용\nexport { signIn, signOut } from \"next-auth/react\";\n"],"names":[],"mappings":"AAAA,0BAA0B;;;;;;;AAC1B;AACA;AAEA;AACA;AAiDA,cAAc;AACd;;;;;AAhDO,MAAM,cAA+B;IAC1C,SAAS;QAAE,UAAU;IAAM;IAC3B,WAAW;QACT,IAAA,mKAAmB,EAAC;YAClB,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAO;gBACtC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,MAAM,QAAQ,aAAa,OAAO,OAAO,iBAAiB;gBAC1D,MAAM,WAAW,aAAa,YAAY;gBAE1C,MAAM,OAAO,MAAM,mHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;oBACxC,OAAO;wBAAE;oBAAM;oBACf,QAAQ;wBAAE,IAAI;wBAAM,OAAO;wBAAM,MAAM;wBAAM,MAAM;wBAAM,UAAU;oBAAK;gBAC1E;gBACA,IAAI,CAAC,MAAM,OAAO;gBAElB,MAAM,KAAK,MAAM,IAAA,4IAAO,EAAC,UAAU,KAAK,QAAQ;gBAChD,IAAI,CAAC,IAAI,OAAO;gBAEhB,OAAO;oBAAE,IAAI,KAAK,EAAE;oBAAE,OAAO,KAAK,KAAK;oBAAE,MAAM,KAAK,IAAI;oBAAE,MAAM,KAAK,IAAI;gBAAQ;YACnF;QACF;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,MAAM,IAAI,GAAG,AAAC,KAAa,IAAI;YACjC;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,QAAQ,IAAI,EAAE;gBACf,QAAQ,IAAI,CAAS,IAAI,GAAG,MAAM,IAAI;YACzC;YACA,OAAO;QACT;IACF;AACF;AAGO,SAAS;IACd,OAAO,IAAA,yJAAgB,EAAC;AAC1B","debugId":null}},
    {"offset": {"line": 182, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app%20v1.2/app/listing/%5Bid%5D/page.tsx"],"sourcesContent":["// app/listing/[id]/page.tsx\nimport { auth } from \"@/lib/auth\";\nimport { prisma } from \"@/lib/db\";\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport { notFound } from \"next/navigation\";\n\nexport default async function ListingDetailPage({\n  params,\n}: {\n  params: Promise<{ id: string }>;\n}) {\n  const { id } = await params;\n  const num = Number.parseInt(id, 10);\n  if (!Number.isFinite(num)) notFound();\n\n  const session = await auth();\n  const meId = (session?.user as any)?.id as string | undefined;\n  const myRole = (session?.user as any)?.role as \"ADMIN\" | \"CLIENT\" | undefined;\n\n  const item = await prisma.listing.findUnique({ where: { id: num } });\n  if (!item) notFound();\n\n  const canEdit = !!meId && (item.ownerId === meId || myRole === \"ADMIN\");\n\n  const photos: string[] = Array.isArray(item.photos) ? (item.photos as string[]) : [];\n\n  const fmt = (n?: number | null) => (n == null ? \"-\" : new Intl.NumberFormat(\"ko-KR\").format(n));\n\n  return (\n    <main className=\"max-w-4xl mx-auto p-4 space-y-4\">\n      <header className=\"flex items-start justify-between gap-3\">\n        <div>\n          <h1 className=\"text-xl font-semibold\">{item.title}</h1>\n          {item.address_area && (\n            <div className=\"text-sm text-neutral-600\">{item.address_area}</div>\n          )}\n        </div>\n        {canEdit && (\n          <Link\n            href={`/listing/${item.id}/edit`}\n            className=\"rounded-lg border px-3 py-1.5 text-sm hover:bg-neutral-50\"\n          >\n            수정\n          </Link>\n        )}\n      </header>\n\n      {photos.length > 0 && (\n        <div className=\"grid grid-cols-2 gap-3\">\n          {photos.slice(0, 2).map((src, i) => (\n            <div key={i} className=\"relative aspect-[4/3] rounded-xl overflow-hidden border bg-neutral-100\">\n              <Image src={src} alt={`photo-${i}`} fill sizes=\"(max-width: 768px) 100vw, 50vw\" style={{ objectFit: \"cover\" }}/>\n            </div>\n          ))}\n        </div>\n      )}\n\n      <section className=\"rounded-2xl border bg-white p-4\">\n        <div className=\"grid grid-cols-2 gap-x-8 gap-y-2 text-sm\">\n          <div>월세: {fmt(item.rent_monthly)}</div>\n          <div>임대보증금: {fmt(item.deposit)}</div>\n          <div>권리금: {fmt(item.goodwill_price)}</div>\n          <div>월매출: {fmt(item.monthly_sales)}</div>\n          <div>주차: {item.parking_spaces ?? 0}대</div>\n        </div>\n      </section>\n    </main>\n  );\n}\n"],"names":[],"mappings":"AAAA,4BAA4B;;;;;;AAC5B;AACA;AACA;AACA;AACA;AAAA;;;;;;;AAEe,eAAe,kBAAkB,EAC9C,MAAM,EAGP;IACC,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;IACrB,MAAM,MAAM,OAAO,QAAQ,CAAC,IAAI;IAChC,IAAI,CAAC,OAAO,QAAQ,CAAC,MAAM,IAAA,iMAAQ;IAEnC,MAAM,UAAU,MAAM,IAAA,mIAAI;IAC1B,MAAM,OAAQ,SAAS,MAAc;IACrC,MAAM,SAAU,SAAS,MAAc;IAEvC,MAAM,OAAO,MAAM,mHAAM,CAAC,OAAO,CAAC,UAAU,CAAC;QAAE,OAAO;YAAE,IAAI;QAAI;IAAE;IAClE,IAAI,CAAC,MAAM,IAAA,iMAAQ;IAEnB,MAAM,UAAU,CAAC,CAAC,QAAQ,CAAC,KAAK,OAAO,KAAK,QAAQ,WAAW,OAAO;IAEtE,MAAM,SAAmB,MAAM,OAAO,CAAC,KAAK,MAAM,IAAK,KAAK,MAAM,GAAgB,EAAE;IAEpF,MAAM,MAAM,CAAC,IAAuB,KAAK,OAAO,MAAM,IAAI,KAAK,YAAY,CAAC,SAAS,MAAM,CAAC;IAE5F,qBACE,8OAAC;QAAK,WAAU;;0BACd,8OAAC;gBAAO,WAAU;;kCAChB,8OAAC;;0CACC,8OAAC;gCAAG,WAAU;0CAAyB,KAAK,KAAK;;;;;;4BAChD,KAAK,YAAY,kBAChB,8OAAC;gCAAI,WAAU;0CAA4B,KAAK,YAAY;;;;;;;;;;;;oBAG/D,yBACC,8OAAC,0LAAI;wBACH,MAAM,CAAC,SAAS,EAAE,KAAK,EAAE,CAAC,KAAK,CAAC;wBAChC,WAAU;kCACX;;;;;;;;;;;;YAMJ,OAAO,MAAM,GAAG,mBACf,8OAAC;gBAAI,WAAU;0BACZ,OAAO,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,KAAK,kBAC5B,8OAAC;wBAAY,WAAU;kCACrB,cAAA,8OAAC,wIAAK;4BAAC,KAAK;4BAAK,KAAK,CAAC,MAAM,EAAE,GAAG;4BAAE,IAAI;4BAAC,OAAM;4BAAiC,OAAO;gCAAE,WAAW;4BAAQ;;;;;;uBADpG;;;;;;;;;;0BAOhB,8OAAC;gBAAQ,WAAU;0BACjB,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;;gCAAI;gCAAK,IAAI,KAAK,YAAY;;;;;;;sCAC/B,8OAAC;;gCAAI;gCAAQ,IAAI,KAAK,OAAO;;;;;;;sCAC7B,8OAAC;;gCAAI;gCAAM,IAAI,KAAK,cAAc;;;;;;;sCAClC,8OAAC;;gCAAI;gCAAM,IAAI,KAAK,aAAa;;;;;;;sCACjC,8OAAC;;gCAAI;gCAAK,KAAK,cAAc,IAAI;gCAAE;;;;;;;;;;;;;;;;;;;;;;;;AAK7C","debugId":null}}]
}