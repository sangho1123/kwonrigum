{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/shop-transfer-1.1/app/compare/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { Listing } from \"@/lib/types\";\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport { useSearchParams } from \"next/navigation\";\nimport { useEffect, useState } from \"react\";\n\n// ✅ 1. 똑같은 만능 이미지 함수 적용\nfunction getThumb(photos: any): string | null {\n  if (!photos) return null;\n  try {\n    if (Array.isArray(photos)) return photos.length > 0 ? (photos[0] as string) : null;\n    if (typeof photos === \"string\") {\n      if (photos === \"[]\") return null;\n      const parsed = JSON.parse(photos);\n      if (Array.isArray(parsed) && parsed.length > 0) return parsed[0];\n    }\n  } catch (e) { return null; }\n  return null;\n}\n\nexport default function ComparePage() {\n  const searchParams = useSearchParams();\n  const ids = searchParams.get(\"ids\")?.split(\",\").map(id => id.trim()) || [];\n  const [listings, setListings] = useState<Listing[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    async function fetchData() {\n      try {\n        const res = await fetch(\"/api/listings\", { \n          cache: \"no-store\",\n          headers: { \"Pragma\": \"no-cache\" }\n        });\n        const data = await res.json();\n        const allListings = data.items || [];\n        const filtered = allListings.filter((item: any) => ids.includes(String(item.id)));\n        setListings(filtered);\n      } catch (e) {\n        console.error(e);\n      } finally {\n        setLoading(false);\n      }\n    }\n    if (ids.length > 0) fetchData();\n    else setLoading(false);\n  }, [searchParams]);\n\n  if (loading) return <div className=\"p-20 text-center\">⏳ 로딩 중...</div>;\n  if (listings.length === 0) return (\n    <div className=\"p-20 text-center\">\n      <h2 className=\"text-xl font-bold mb-4\">비교할 매물이 없습니다.</h2>\n      <Link href=\"/\" className=\"text-blue-600 underline\">홈으로 돌아가기</Link>\n    </div>\n  );\n\n  const rows = [\n    { label: \"매물명\", render: (l: any) => <span className=\"font-bold\">{l.title}</span> },\n    { label: \"권리금\", render: (l: any) => <span className=\"text-blue-600 font-bold\">{l.goodwill_price?.toLocaleString()}만원</span> },\n    { label: \"보증금/월세\", render: (l: any) => `${l.deposit?.toLocaleString()} / ${l.rent_monthly?.toLocaleString()}` },\n    { label: \"월 매출\", render: (l: any) => l.monthly_sales ? `${l.monthly_sales.toLocaleString()}만원` : \"-\" },\n    { label: \"평수/층\", render: (l: any) => `${l.area_pyeong ?? 0}평 / ${l.floor ?? 1}층` },\n    { label: \"업종\", render: (l: any) => l.sector },\n    { label: \"\", render: (l: any) => (\n        <Link href={`/listing/${l.id}`} className=\"block w-full text-center bg-blue-600 text-white py-2 rounded text-sm hover:bg-blue-700\">상세보기</Link>\n    )},\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 pb-20 pt-8\">\n      <div className=\"container mx-auto px-4\">\n        <h1 className=\"text-2xl font-bold mb-6\">⚖️ 매물 비교하기</h1>\n        <div className=\"overflow-x-auto bg-white rounded-xl shadow border\">\n          <table className=\"w-full text-left border-collapse min-w-[700px]\">\n            <thead>\n              <tr>\n                <th className=\"p-4 bg-gray-50 border-b w-32 font-medium text-gray-500 sticky left-0 z-10\">구분</th>\n                {listings.map((l) => (\n                  <th key={l.id} className=\"p-4 border-b min-w-[200px] align-top\">\n                    {/* 이미지 영역 */}\n                    <div className=\"relative aspect-video w-full rounded-lg overflow-hidden bg-gray-100 mb-2\">\n                       {getThumb((l as any).photos) ? (\n                          <Image src={getThumb((l as any).photos)!} alt={l.title} fill className=\"object-cover\" />\n                       ) : (\n                          <div className=\"flex items-center justify-center h-full text-gray-400 text-xs\">No Image</div>\n                       )}\n                    </div>\n                  </th>\n                ))}\n              </tr>\n            </thead>\n            <tbody>\n              {rows.map((row, idx) => (\n                <tr key={idx} className=\"hover:bg-gray-50\">\n                  <td className=\"p-4 border-b bg-gray-50 font-medium text-gray-600 sticky left-0 z-10\">{row.label}</td>\n                  {listings.map((l) => (\n                    <td key={l.id} className=\"p-4 border-b text-center text-gray-800\">{row.render(l)}</td>\n                  ))}\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}