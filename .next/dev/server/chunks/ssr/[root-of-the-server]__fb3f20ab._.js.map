{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 24, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app%20v1.2/lib/db.ts"],"sourcesContent":["// lib/db.ts\nimport { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = globalThis as unknown as { prisma?: PrismaClient };\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: process.env.NODE_ENV === \"development\" ? [\"query\", \"error\", \"warn\"] : [\"error\"],\n  });\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":"AAAA,YAAY;;;;;AACZ;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;AAC7E;AAEF,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app%20v1.2/lib/auth.ts"],"sourcesContent":["// lib/auth.ts\nimport { prisma } from \"@/lib/db\";\nimport { compare } from \"bcryptjs\";\nimport NextAuth from \"next-auth\";\nimport Credentials from \"next-auth/providers/credentials\";\n\nexport const {\n  handlers: { GET, POST },\n  auth,\n  signIn,\n  signOut,\n} = NextAuth({\n  session: { strategy: \"jwt\" },\n  pages: { signIn: \"/login\" },\n\n  providers: [\n    Credentials({\n      name: \"이메일/비밀번호\",\n      credentials: {\n        email: { label: \"이메일\", type: \"email\" },\n        password: { label: \"비밀번호\", type: \"password\" },\n      },\n      authorize: async (creds) => {\n        const email = (creds?.email ?? \"\").toLowerCase().trim();\n        const password = creds?.password ?? \"\";\n        if (!email || !password) return null;\n\n        const user = await prisma.user.findUnique({ where: { email } });\n        if (!user) return null;\n\n        const ok = await compare(password, user.passwordHash);\n        if (!ok) return null;\n\n        return {\n          id: user.id,\n          email: user.email,\n          name: user.name ?? undefined,\n          role: user.role, // \"ADMIN\" | \"CLIENT\"\n        };\n      },\n    }),\n  ],\n\n  callbacks: {\n    authorized({ auth, request }) {\n      const path = request.nextUrl.pathname;\n\n      // 관리자 전용\n      if (path.startsWith(\"/admin\")) {\n        return !!auth?.user && (auth.user as any).role === \"ADMIN\";\n      }\n\n      // 로그인 필요\n      if (path.startsWith(\"/chat\")) return !!auth?.user;\n      if (path === \"/listing/new\") return !!auth?.user;\n      if (/^\\/listing\\/\\d+\\/edit$/.test(path)) return !!auth?.user;\n\n      return true;\n    },\n\n    async jwt({ token, user }) {\n      if (user) {\n        token.id = (user as any).id;\n        token.role = (user as any).role ?? \"CLIENT\";\n      }\n      return token;\n    },\n\n    async session({ session, token }) {\n      if (session.user) {\n        (session.user as any).id = token.id as string | undefined;\n        (session.user as any).role = token.role as string | undefined;\n      }\n      return session;\n    },\n  },\n});\n"],"names":[],"mappings":"AAAA,cAAc;;;;;;;;;;;;;AACd;AACA;AACA;AACA;;;;;AAEO,MAAM,EACX,UAAU,EAAE,GAAG,EAAE,IAAI,EAAE,EACvB,IAAI,EACJ,MAAM,EACN,OAAO,EACR,GAAG,IAAA,gJAAQ,EAAC;IACX,SAAS;QAAE,UAAU;IAAM;IAC3B,OAAO;QAAE,QAAQ;IAAS;IAE1B,WAAW;QACT,IAAA,mKAAW,EAAC;YACV,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAO,MAAM;gBAAQ;gBACrC,UAAU;oBAAE,OAAO;oBAAQ,MAAM;gBAAW;YAC9C;YACA,WAAW,OAAO;gBAChB,MAAM,QAAQ,CAAC,OAAO,SAAS,EAAE,EAAE,WAAW,GAAG,IAAI;gBACrD,MAAM,WAAW,OAAO,YAAY;gBACpC,IAAI,CAAC,SAAS,CAAC,UAAU,OAAO;gBAEhC,MAAM,OAAO,MAAM,mHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;oBAAE,OAAO;wBAAE;oBAAM;gBAAE;gBAC7D,IAAI,CAAC,MAAM,OAAO;gBAElB,MAAM,KAAK,MAAM,IAAA,4IAAO,EAAC,UAAU,KAAK,YAAY;gBACpD,IAAI,CAAC,IAAI,OAAO;gBAEhB,OAAO;oBACL,IAAI,KAAK,EAAE;oBACX,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI,IAAI;oBACnB,MAAM,KAAK,IAAI;gBACjB;YACF;QACF;KACD;IAED,WAAW;QACT,YAAW,EAAE,IAAI,EAAE,OAAO,EAAE;YAC1B,MAAM,OAAO,QAAQ,OAAO,CAAC,QAAQ;YAErC,SAAS;YACT,IAAI,KAAK,UAAU,CAAC,WAAW;gBAC7B,OAAO,CAAC,CAAC,MAAM,QAAQ,AAAC,KAAK,IAAI,CAAS,IAAI,KAAK;YACrD;YAEA,SAAS;YACT,IAAI,KAAK,UAAU,CAAC,UAAU,OAAO,CAAC,CAAC,MAAM;YAC7C,IAAI,SAAS,gBAAgB,OAAO,CAAC,CAAC,MAAM;YAC5C,IAAI,yBAAyB,IAAI,CAAC,OAAO,OAAO,CAAC,CAAC,MAAM;YAExD,OAAO;QACT;QAEA,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,AAAC,KAAa,EAAE;gBAC3B,MAAM,IAAI,GAAG,AAAC,KAAa,IAAI,IAAI;YACrC;YACA,OAAO;QACT;QAEA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,QAAQ,IAAI,EAAE;gBACf,QAAQ,IAAI,CAAS,EAAE,GAAG,MAAM,EAAE;gBAClC,QAAQ,IAAI,CAAS,IAAI,GAAG,MAAM,IAAI;YACzC;YACA,OAAO;QACT;IACF;AACF","debugId":null}},
    {"offset": {"line": 193, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app%20v1.2/app/listing/%5Bid%5D/page.tsx"],"sourcesContent":["// app/listing/[id]/page.tsx\nimport { auth } from \"@/lib/auth\";\nimport { prisma } from \"@/lib/db\";\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport { notFound } from \"next/navigation\";\n\nexport default async function ListingDetailPage({\n  params,\n}: {\n  params: Promise<{ id: string }>;\n}) {\n  const { id } = await params;\n  const num = Number.parseInt(id, 10);\n  if (!Number.isFinite(num)) notFound();\n\n  const session = await auth();\n  const meId = (session?.user as any)?.id as string | undefined;\n  const myRole = (session?.user as any)?.role as \"ADMIN\" | \"CLIENT\" | undefined;\n\n  const item = await prisma.listing.findUnique({ where: { id: num } });\n  if (!item) notFound();\n\n  const canEdit = !!meId && (item.ownerId === meId || myRole === \"ADMIN\");\n\n  const photos: string[] = Array.isArray(item.photos) ? (item.photos as string[]) : [];\n\n  const fmt = (n?: number | null) => (n == null ? \"-\" : new Intl.NumberFormat(\"ko-KR\").format(n));\n\n  return (\n    <main className=\"max-w-4xl mx-auto p-4 space-y-4\">\n      <header className=\"flex items-start justify-between gap-3\">\n        <div>\n          <h1 className=\"text-xl font-semibold\">{item.title}</h1>\n          {item.address_area && (\n            <div className=\"text-sm text-neutral-600\">{item.address_area}</div>\n          )}\n        </div>\n        {canEdit && (\n          <Link\n            href={`/listing/${item.id}/edit`}\n            className=\"rounded-lg border px-3 py-1.5 text-sm hover:bg-neutral-50\"\n          >\n            수정\n          </Link>\n        )}\n      </header>\n\n      {photos.length > 0 && (\n        <div className=\"grid grid-cols-2 gap-3\">\n          {photos.slice(0, 2).map((src, i) => (\n            <div key={i} className=\"relative aspect-[4/3] rounded-xl overflow-hidden border bg-neutral-100\">\n              <Image src={src} alt={`photo-${i}`} fill sizes=\"(max-width: 768px) 100vw, 50vw\" style={{ objectFit: \"cover\" }}/>\n            </div>\n          ))}\n        </div>\n      )}\n\n      <section className=\"rounded-2xl border bg-white p-4\">\n        <div className=\"grid grid-cols-2 gap-x-8 gap-y-2 text-sm\">\n          <div>월세: {fmt(item.rent_monthly)}</div>\n          <div>임대보증금: {fmt(item.deposit)}</div>\n          <div>권리금: {fmt(item.goodwill_price)}</div>\n          <div>월매출: {fmt(item.monthly_sales)}</div>\n          <div>주차: {item.parking_spaces ?? 0}대</div>\n        </div>\n      </section>\n    </main>\n  );\n}\n"],"names":[],"mappings":"AAAA,4BAA4B;;;;;;AAC5B;AACA;AACA;AACA;AACA;AAAA;;;;;;;AAEe,eAAe,kBAAkB,EAC9C,MAAM,EAGP;IACC,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;IACrB,MAAM,MAAM,OAAO,QAAQ,CAAC,IAAI;IAChC,IAAI,CAAC,OAAO,QAAQ,CAAC,MAAM,IAAA,iMAAQ;IAEnC,MAAM,UAAU,MAAM,IAAA,mHAAI;IAC1B,MAAM,OAAQ,SAAS,MAAc;IACrC,MAAM,SAAU,SAAS,MAAc;IAEvC,MAAM,OAAO,MAAM,mHAAM,CAAC,OAAO,CAAC,UAAU,CAAC;QAAE,OAAO;YAAE,IAAI;QAAI;IAAE;IAClE,IAAI,CAAC,MAAM,IAAA,iMAAQ;IAEnB,MAAM,UAAU,CAAC,CAAC,QAAQ,CAAC,KAAK,OAAO,KAAK,QAAQ,WAAW,OAAO;IAEtE,MAAM,SAAmB,MAAM,OAAO,CAAC,KAAK,MAAM,IAAK,KAAK,MAAM,GAAgB,EAAE;IAEpF,MAAM,MAAM,CAAC,IAAuB,KAAK,OAAO,MAAM,IAAI,KAAK,YAAY,CAAC,SAAS,MAAM,CAAC;IAE5F,qBACE,8OAAC;QAAK,WAAU;;0BACd,8OAAC;gBAAO,WAAU;;kCAChB,8OAAC;;0CACC,8OAAC;gCAAG,WAAU;0CAAyB,KAAK,KAAK;;;;;;4BAChD,KAAK,YAAY,kBAChB,8OAAC;gCAAI,WAAU;0CAA4B,KAAK,YAAY;;;;;;;;;;;;oBAG/D,yBACC,8OAAC,0LAAI;wBACH,MAAM,CAAC,SAAS,EAAE,KAAK,EAAE,CAAC,KAAK,CAAC;wBAChC,WAAU;kCACX;;;;;;;;;;;;YAMJ,OAAO,MAAM,GAAG,mBACf,8OAAC;gBAAI,WAAU;0BACZ,OAAO,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,KAAK,kBAC5B,8OAAC;wBAAY,WAAU;kCACrB,cAAA,8OAAC,wIAAK;4BAAC,KAAK;4BAAK,KAAK,CAAC,MAAM,EAAE,GAAG;4BAAE,IAAI;4BAAC,OAAM;4BAAiC,OAAO;gCAAE,WAAW;4BAAQ;;;;;;uBADpG;;;;;;;;;;0BAOhB,8OAAC;gBAAQ,WAAU;0BACjB,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;;gCAAI;gCAAK,IAAI,KAAK,YAAY;;;;;;;sCAC/B,8OAAC;;gCAAI;gCAAQ,IAAI,KAAK,OAAO;;;;;;;sCAC7B,8OAAC;;gCAAI;gCAAM,IAAI,KAAK,cAAc;;;;;;;sCAClC,8OAAC;;gCAAI;gCAAM,IAAI,KAAK,aAAa;;;;;;;sCACjC,8OAAC;;gCAAI;gCAAK,KAAK,cAAc,IAAI;gCAAE;;;;;;;;;;;;;;;;;;;;;;;;AAK7C","debugId":null}}]
}