{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 24, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app-1.3/lib/db.ts"],"sourcesContent":["// lib/db.ts\nimport { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = globalThis as unknown as { prisma?: PrismaClient };\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: process.env.NODE_ENV === \"development\" ? [\"query\", \"error\", \"warn\"] : [\"error\"],\n  });\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":"AAAA,YAAY;;;;;AACZ;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;AAC7E;AAEF,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app-1.3/lib/auth.ts"],"sourcesContent":["// lib/auth.ts\nimport { prisma } from \"@/lib/db\";\nimport { compare } from \"bcryptjs\";\nimport NextAuth, { type NextAuthConfig } from \"next-auth\";\nimport Credentials from \"next-auth/providers/credentials\";\n\nexport const authOptions: NextAuthConfig = {\n  session: { strategy: \"jwt\" },\n  pages: { signIn: \"/login\" },\n  providers: [\n    Credentials({\n      name: \"Credentials\",\n      credentials: {\n        email: { label: \"Ïù¥Î©îÏùº\", type: \"email\" },\n        password: { label: \"ÎπÑÎ∞ÄÎ≤àÌò∏\", type: \"password\" },\n      },\n      authorize: async (creds) => {\n        const email =\n          typeof creds?.email === \"string\" ? creds.email.trim().toLowerCase() : \"\";\n        const password =\n          typeof creds?.password === \"string\" ? creds.password.trim() : \"\";\n      \n        if (!email || !password) return null;\n      \n        const user = await prisma.user.findUnique({\n          where: { email },\n          select: { id: true, email: true, name: true, role: true, password: true },\n        });\n        if (!user || !user.password) return null;\n      \n        const ok = await compare(password, user.password);\n        if (!ok) return null;\n      \n        return {\n          id: user.id,\n          name: user.name ?? user.email,\n          email: user.email,\n          role: user.role,\n        } as any;\n      }\n    }),\n  ],\n  callbacks: {\n    async jwt({ token, user }: { token: import(\"next-auth/jwt\").JWT; user?: any }) {\n      if (user) {\n        token.id = user.id;\n        token.role = user.role;\n      }\n      return token;\n    },\n    async session({\n      session,\n      token,\n    }: {\n      session: import(\"next-auth\").Session;\n      token: import(\"next-auth/jwt\").JWT;\n    }) {\n      if (session.user) {\n        (session.user as any).id = token.id as string;\n        (session.user as any).role = token.role as string;\n      }\n      return session;\n    },\n  },\n};\n\nexport const { handlers, auth, signIn, signOut } = NextAuth(authOptions);\n"],"names":[],"mappings":"AAAA,cAAc;;;;;;;;;;;;;AACd;AACA;AACA;AACA;AAAA;;;;;AAEO,MAAM,cAA8B;IACzC,SAAS;QAAE,UAAU;IAAM;IAC3B,OAAO;QAAE,QAAQ;IAAS;IAC1B,WAAW;QACT,IAAA,qKAAW,EAAC;YACV,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAO,MAAM;gBAAQ;gBACrC,UAAU;oBAAE,OAAO;oBAAQ,MAAM;gBAAW;YAC9C;YACA,WAAW,OAAO;gBAChB,MAAM,QACJ,OAAO,OAAO,UAAU,WAAW,MAAM,KAAK,CAAC,IAAI,GAAG,WAAW,KAAK;gBACxE,MAAM,WACJ,OAAO,OAAO,aAAa,WAAW,MAAM,QAAQ,CAAC,IAAI,KAAK;gBAEhE,IAAI,CAAC,SAAS,CAAC,UAAU,OAAO;gBAEhC,MAAM,OAAO,MAAM,mHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;oBACxC,OAAO;wBAAE;oBAAM;oBACf,QAAQ;wBAAE,IAAI;wBAAM,OAAO;wBAAM,MAAM;wBAAM,MAAM;wBAAM,UAAU;oBAAK;gBAC1E;gBACA,IAAI,CAAC,QAAQ,CAAC,KAAK,QAAQ,EAAE,OAAO;gBAEpC,MAAM,KAAK,MAAM,IAAA,4IAAO,EAAC,UAAU,KAAK,QAAQ;gBAChD,IAAI,CAAC,IAAI,OAAO;gBAEhB,OAAO;oBACL,IAAI,KAAK,EAAE;oBACX,MAAM,KAAK,IAAI,IAAI,KAAK,KAAK;oBAC7B,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI;gBACjB;YACF;QACF;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAsD;YAC3E,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,KAAK,EAAE;gBAClB,MAAM,IAAI,GAAG,KAAK,IAAI;YACxB;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EACZ,OAAO,EACP,KAAK,EAIN;YACC,IAAI,QAAQ,IAAI,EAAE;gBACf,QAAQ,IAAI,CAAS,EAAE,GAAG,MAAM,EAAE;gBAClC,QAAQ,IAAI,CAAS,IAAI,GAAG,MAAM,IAAI;YACzC;YACA,OAAO;QACT;IACF;AACF;AAEO,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,GAAG,IAAA,gKAAQ,EAAC","debugId":null}},
    {"offset": {"line": 142, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/my-shop-transfer-app-1.3/app/listing/%5Bid%5D/leads/page.tsx"],"sourcesContent":["// app/listing/[id]/leads/page.tsx\nexport const dynamic = \"force-dynamic\";\n\nimport { auth } from \"@/lib/auth\";\nimport { prisma } from \"@/lib/db\";\nimport Link from \"next/link\";\nimport { notFound, redirect } from \"next/navigation\";\n\n// Next 14/15 Ìò∏Ìôò: paramsÍ∞Ä Promise/Í∞ùÏ≤¥ Îëò Îã§ Ïò¨ Ïàò ÏûàÏúºÎãà Í≥µÌÜµ Ï≤òÎ¶¨\ntype Params = { id: string } | Promise<{ id: string }>;\n\nexport default async function ListingLeadsPage({\n  params,\n}: {\n  params: Params;\n}) {\n  // paramsÍ∞Ä PromiseÎì† Í∑∏ÎÉ• Í∞ùÏ≤¥Îì† Ïó¨Í∏∞ÏÑú ÌÜµÏùºÌï¥ÏÑú Í∫ºÎÉÑ\n  const { id } = await Promise.resolve(params as any);\n  const listingId = Number(id);\n  if (!Number.isFinite(listingId)) notFound();\n\n  // --- Ïù∏Ï¶ù ---\n  const session = await auth();\n  const meId = (session?.user as any)?.id as string | undefined;\n  const role = (session?.user as any)?.role as \"ADMIN\" | \"CLIENT\" | undefined;\n\n  if (!meId) {\n    redirect(\"/login\");\n  }\n\n  // --- Îß§Î¨º Ï°∞Ìöå ---\n  const listing = await prisma.listing.findUnique({\n    where: { id: listingId },\n    select: {\n      id: true,\n      title: true,\n      ownerId: true,\n    },\n  });\n\n  if (!listing) notFound();\n\n  // ownerIdÍ∞Ä ÎπÑÏñ¥ ÏûàÎäî(ÏòõÎÇ† ÎçîÎØ∏ Îç∞Ïù¥ÌÑ∞)ÎèÑ Î≥¥Í≤å ÌóàÏö©\n  const isOwner = !listing.ownerId || listing.ownerId === meId;\n  const isAdmin = role === \"ADMIN\";\n\n  // üî• Ïù¥Ï†úÎäî Î∞îÎ°ú redirect(\"/\") Ïïà ÌïòÍ≥†, Í∂åÌïú ÏóÜÏúºÎ©¥ ÌôîÎ©¥Ïóê ÏïàÎÇ¥ Î¨∏Íµ¨Î•º Î≥¥Ïó¨Ï§å\n  if (!isOwner && !isAdmin) {\n    return (\n      <main className=\"max-w-3xl mx-auto p-6 space-y-4\">\n        <header className=\"flex items-center justify-between gap-2\">\n          <div>\n            <h1 className=\"text-xl font-semibold\">Îß§Î¨º Î¶¨Îìú Î™©Î°ù Ï†ëÍ∑º Î∂àÍ∞Ä</h1>\n            <p className=\"text-sm text-neutral-600\">\n              Ïù¥ Îß§Î¨ºÏùò Î¶¨ÎìúÎ•º Î≥º Í∂åÌïúÏù¥ ÏóÜÏäµÎãàÎã§.\n            </p>\n          </div>\n          <Link\n            href=\"/listing/mine\"\n            className=\"text-sm rounded-lg border px-3 py-1.5 hover:bg-neutral-50\"\n          >\n            ‚Üê ÎÇ¥ Îß§Î¨ºÎ°ú\n          </Link>\n        </header>\n      </main>\n    );\n  }\n\n  // --- Î¶¨Îìú Î™©Î°ù Ï°∞Ìöå (Prisma Lead ÌÖåÏù¥Î∏î Í∏∞Ï§Ä) ---\n  const leads = await prisma.lead.findMany({\n    where: { listingId },\n    orderBy: { createdAt: \"desc\" },\n    select: {\n      id: true,\n      type: true,\n      name: true,\n      phone: true,\n      message: true,\n      partnerId: true,\n      createdAt: true,\n    },\n  });\n\n  const fmtDateTime = (d: Date) =>\n    d.toLocaleString(\"ko-KR\", {\n      month: \"2-digit\",\n      day: \"2-digit\",\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n    });\n\n  const labelFromType = (type: string) => {\n    switch (type) {\n      case \"listing\":\n        return \"ÏùºÎ∞ò Î¨∏Ïùò\";\n      case \"loan\":\n        return \"ÎåÄÏ∂ú ÏÉÅÎã¥\";\n      case \"fitout\":\n        return \"Ïù∏ÌÖåÎ¶¨Ïñ¥ ÏÉÅÎã¥\";\n      case \"closure\":\n        return \"ÏûÑÏ∞®/Ï†ïÎ¶¨ ÏÉÅÎã¥\";\n      default:\n        return type;\n    }\n  };\n\n  return (\n    <main className=\"max-w-5xl mx-auto p-6 space-y-4\">\n      <header className=\"flex items-center justify-between gap-2\">\n        <div>\n          <h1 className=\"text-xl font-semibold\">\n            Îß§Î¨º Î¶¨Îìú Î™©Î°ù #{listing.id}\n          </h1>\n          <p className=\"text-sm text-neutral-600\">\n            {listing.title || \"Ï†úÎ™© ÏóÜÏùå\"}\n          </p>\n        </div>\n        <Link\n          href={`/listing/${listing.id}`}\n          className=\"text-sm rounded-lg border px-3 py-1.5 hover:bg-neutral-50\"\n        >\n          ‚Üê Îß§Î¨º ÏÉÅÏÑ∏Î°ú\n        </Link>\n      </header>\n\n      {leads.length === 0 ? (\n        <div className=\"rounded-lg border bg-white p-4 text-sm text-neutral-600\">\n          Ïù¥ Îß§Î¨ºÎ°ú Ïú†ÏûÖÎêú Î¶¨ÎìúÍ∞Ä ÏïÑÏßÅ ÏóÜÏäµÎãàÎã§.\n        </div>\n      ) : (\n        <div className=\"rounded-lg border bg-white overflow-hidden\">\n          <table className=\"w-full text-sm\">\n            <thead className=\"bg-neutral-50\">\n              <tr>\n                <th className=\"px-3 py-2 text-left w-40\">ÏãúÍ∞Ñ</th>\n                <th className=\"px-3 py-2 text-left w-28\">ÌÉÄÏûÖ</th>\n                <th className=\"px-3 py-2 text-left w-28\">Ïù¥Î¶Ñ</th>\n                <th className=\"px-3 py-2 text-left w-40\">Ïó∞ÎùΩÏ≤ò</th>\n                <th className=\"px-3 py-2 text-left\">Î©îÎ™®</th>\n                <th className=\"px-3 py-2 text-left w-28\">ÌååÌä∏ÎÑà</th>\n              </tr>\n            </thead>\n            <tbody>\n              {leads.map((l) => (\n                <tr key={l.id} className=\"border-t align-top\">\n                  <td className=\"px-3 py-2\">\n                    {fmtDateTime(l.createdAt as Date)}\n                  </td>\n                  <td className=\"px-3 py-2\">\n                    {labelFromType(l.type as string)}\n                  </td>\n                  <td className=\"px-3 py-2\">{l.name}</td>\n                  <td className=\"px-3 py-2\">{l.phone}</td>\n                  <td className=\"px-3 py-2 whitespace-pre-wrap\">\n                    {l.message || \"-\"}\n                  </td>\n                  <td className=\"px-3 py-2\">{l.partnerId ?? \"-\"}</td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      )}\n    </main>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}