{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/shop-transfer-1.1/lib/db.ts"],"sourcesContent":["// lib/db.ts\nimport { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = globalThis as unknown as { prisma?: PrismaClient };\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: process.env.NODE_ENV === \"development\" ? [\"query\", \"error\", \"warn\"] : [\"error\"],\n  });\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":"AAAA,YAAY;;;;;AACZ;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;AAC7E;AAEF,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 78, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sanghojeong/Desktop/Projects/%EA%B6%8C%EB%A6%AC%EA%B8%88%EC%A4%91%EA%B0%9C%EC%95%B1/shop-transfer-1.1/app/api/register/route.ts"],"sourcesContent":["// app/api/register/route.ts\nimport { prisma } from \"@/lib/db\";\nimport { hash } from \"bcryptjs\";\nimport { NextResponse } from \"next/server\";\n\nexport async function POST(req: Request) {\n  try {\n    const body = await req.json();\n\n    const name =\n      typeof body.name === \"string\" ? body.name.trim() : \"\";\n    const email =\n      typeof body.email === \"string\"\n        ? body.email.trim().toLowerCase()\n        : \"\";\n    const password =\n      typeof body.password === \"string\" ? body.password.trim() : \"\";\n\n    // 필수값 체크\n    if (!email || !password) {\n      return NextResponse.json(\n        { ok: false, error: \"이메일과 비밀번호는 필수입니다.\" },\n        { status: 400 }\n      );\n    }\n\n    // 중복 이메일 체크\n    const exists = await prisma.user.findUnique({\n      where: { email },\n      select: { id: true },\n    });\n    if (exists) {\n      return NextResponse.json(\n        { ok: false, error: \"이미 가입된 이메일입니다.\" },\n        { status: 400 }\n      );\n    }\n\n    // 비밀번호 해시\n    const hashed = await hash(password, 10);\n\n    // 기본은 CLIENT 권한으로 가입 (관리자는 따로 수동 생성)\n    const user = await prisma.user.create({\n      data: {\n        email,\n        name: name || null,\n        password: hashed,\n        role: \"CLIENT\", // Prisma schema 에 맞춰서 사용\n      },\n      select: { id: true, email: true, role: true },\n    });\n\n    return NextResponse.json({ ok: true, user });\n  } catch (e: any) {\n    console.error(\"[REGISTER_ERROR]\", e);\n    return NextResponse.json(\n      { ok: false, error: e?.message || \"서버 오류\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":"AAAA,4BAA4B;;;;;AAC5B;AACA;AACA;;;;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAE3B,MAAM,OACJ,OAAO,KAAK,IAAI,KAAK,WAAW,KAAK,IAAI,CAAC,IAAI,KAAK;QACrD,MAAM,QACJ,OAAO,KAAK,KAAK,KAAK,WAClB,KAAK,KAAK,CAAC,IAAI,GAAG,WAAW,KAC7B;QACN,MAAM,WACJ,OAAO,KAAK,QAAQ,KAAK,WAAW,KAAK,QAAQ,CAAC,IAAI,KAAK;QAE7D,SAAS;QACT,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,IAAI;gBAAO,OAAO;YAAoB,GACxC;gBAAE,QAAQ;YAAI;QAElB;QAEA,YAAY;QACZ,MAAM,SAAS,MAAM,qHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YAC1C,OAAO;gBAAE;YAAM;YACf,QAAQ;gBAAE,IAAI;YAAK;QACrB;QACA,IAAI,QAAQ;YACV,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,IAAI;gBAAO,OAAO;YAAiB,GACrC;gBAAE,QAAQ;YAAI;QAElB;QAEA,UAAU;QACV,MAAM,SAAS,MAAM,IAAA,2IAAI,EAAC,UAAU;QAEpC,qCAAqC;QACrC,MAAM,OAAO,MAAM,qHAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YACpC,MAAM;gBACJ;gBACA,MAAM,QAAQ;gBACd,UAAU;gBACV,MAAM;YACR;YACA,QAAQ;gBAAE,IAAI;gBAAM,OAAO;gBAAM,MAAM;YAAK;QAC9C;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM;QAAK;IAC5C,EAAE,OAAO,GAAQ;QACf,QAAQ,KAAK,CAAC,oBAAoB;QAClC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,IAAI;YAAO,OAAO,GAAG,WAAW;QAAQ,GAC1C;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}